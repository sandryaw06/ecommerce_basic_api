{
  "name": "cityworks_source",
  "metadata": {
    "vdcType": "endpoint"
  },
  "title": "Cityworks",
  "namespaces": [
    {
      "_primary": [
        "name"
      ],
      "slug": "cenit",
      "name": "Cenit"
    },
    {
      "_primary": [
        "name"
      ],
      "slug": "cityworks",
      "name": "Cityworks"
    },
    {
      "_primary": [
        "name"
      ],
      "slug": "_laserfiche",
      "name": "Cityworks - Laserfiche",
      "settings_schema": "{\r\n    \"title\": \"Cityworks - Laserfiche (New Architecture)\",\r\n    \"type\": \"object\",\r\n    \"properties\": {\r\n      \"authorization\": {\r\n        \"type\": \"string\"\r\n      },\r\n      \"baseFolder\": {\r\n        \"type\": \"string\"\r\n      },\r\n      \"saveToVolume\": {\r\n        \"type\": \"string\",\r\n        \"enum\": [\"Default\"]\r\n      }\r\n    }\r\n}",
      "settings": "{\r\n  \"authorization\": \"64c916801e480a00f4001878\",\r\n  \"baseFolder\": \"/DEV/cityworks\"\r\n}"
    },
    {
      "_primary": [
        "name"
      ],
      "slug": "test_2",
      "name": "Test",
      "settings_schema": "{\r\n    \"title\": \"Sample Controls\",\r\n    \"type\": \"object\",\r\n    \"properties\": {\r\n      \"stringinput\": {\r\n        \"type\": \"string\"\r\n      },\r\n      \"booleaninput\": {\r\n        \"type\": \"boolean\"\r\n      },\r\n      \"dropdownlistknown\": {\r\n        \"type\": \"string\",\r\n        \"enum\": [\"one\", \"two\", \"three\"]\r\n      },\r\n      \"mappinginput\": {\r\n        \"type\": \"string\"\r\n      },\r\n      \"bluebeamtaskstatusselector\": {\r\n        \"type\": \"string\"\r\n      }\r\n    }\r\n}",
      "settings": "{}"
    },
    {
      "_primary": [
        "name"
      ],
      "slug": "_bluebeam_studio",
      "name": "Cityworks - Bluebeam Studio",
      "settings_schema": "{\r\n  \"title\": \"Test form\",\r\n  \"type\": \"object\",\r\n  \"properties\": {\r\n    \"task_status_after\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"task_status_code_after\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"doc_status_before\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"doc_status_after\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"approved_deliverable_markup_label\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"revisions_required_markup_label\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"review_corrections_route_docs\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"review_corrections_no_review\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"review_corrections_route_docs_task\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"review_corrections_route_docs_task_code\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"review_corrections_no_review_task\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"review_corrections_no_review_task_code\": {\r\n      \"type\": \"string\"\r\n    }\r\n   \r\n    \r\n  }\r\n}",
      "settings": "{\n  \"session_send_email_to_users\": true,\n  \"project_send_email_to_users\": true,\n  \"task_status_after\": \"DOCUMENTS ROUTED\",\n  \"task_status_code_after\": \"DOCSROUTED\",\n  \"doc_status_after\": \"ROUTED TO BLUEBEAM\",\n  \"doc_status_before\": \"PLAN REVIEW\",\n  \"revisions_required_markup_label\": \"REVISIONS_REQUIRED\",\n  \"approved_deliverable_markup_label\": \"APPROVED\",\n  \"review_corrections_route_docs\": \"ROUTE DOCS\",\n  \"review_corrections_no_review\": \"NO REVIEW\",\n  \"review_corrections_route_docs_task\": \"DOCS IN BLUEBEAM\",\n  \"review_corrections_route_docs_task_code\": \"DOCSINBB\",\n  \"review_corrections_no_review_task\": \"NO REVIEW\",\n  \"review_corrections_no_review_task_code\": \"NOREVIEW\"\n}"
    },
    {
      "_primary": [
        "name"
      ],
      "slug": "_bluebealm_studio",
      "name": "Cityworks - Bluebealm Studio"
    },
    {
      "_primary": [
        "name"
      ],
      "slug": "citiworks",
      "name": "Citiworks"
    }
  ],
  "flows": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Create WorkOrder",
      "data_type_scope": "Event source",
      "queue": "primary",
      "event": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "work_order_created"
      },
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create WorkOrder Template"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Create WorkOrder"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create WorkOrder Parse"
      },
      "after_process_callbacks": [
        {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "create_workorder_after_callback"
        }
      ],
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get CaseDetails by Task",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get CaseDetails by Task Parser"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Get CaseTask by TaskId"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_details_by_task_before_submit"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get Case Documents",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Case Documents Parser"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "CaseRelDocs ByCaObjectId"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_documents_before_submit"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Set Task Status",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Set Task Status Template"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Set Task Status"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Check respnse parser"
      },
      "response_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "after_process_callbacks": [
        {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "check_flow_response"
        }
      ],
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add Comment",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Comment Parse"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Add Comment"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "add_comment_template"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Update Document",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Update Document Template"
      },
      "webhook": {
        "_reference": true,
        "method": "put",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "CaseRelDocs Update"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Update Document Parser"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Update Task",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Update task template"
      },
      "webhook": {
        "_reference": true,
        "method": "put",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Update Task"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Check respnse parser"
      },
      "response_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Action Manager Events"
      },
      "after_process_callbacks": [
        {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "after_process_update_task"
        }
      ],
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get Document by Id",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Document by Id Parse"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "CaseRelDocs By Id"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_document_by_id_template"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Create Task",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create Task Template"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Add Task"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create Task Check response parser"
      },
      "response_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "after_process_callbacks": [
        {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "create_task_check_flow_response"
        }
      ],
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get WorkOrder Documents",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get WorkOrder Documents Parse"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Get WorkOrder Documents"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_workorder_documents_template"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get User",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get User Template"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Get Users"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get User Parser"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add Document to Case",
      "data_type_scope": "Event source",
      "queue": "primary",
      "event": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_document"
      },
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Document case translator"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "CaseRelDocs Add"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Document to case parser"
      },
      "response_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Search Case Contractor",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Search Case Contractor Parse"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "CaseContractor"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "search_case_contractor_template"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add Document to WorkOrder",
      "queue": "primary",
      "event": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "new_workorder_document_created"
      },
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Document to WorkOrder Parse"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Add Document to WorkOrder"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "add_document_to_workorder_template"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Delete Task",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Delete Task Template"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Delete task"
        }
      },
      "active": true,
      "notify_request": true,
      "notify_response": true
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add AttachmentLink to WorkOrder",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add AttachmentLink Template"
      },
      "webhook": {
        "_reference": true,
        "method": "post",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "AddActivityFileLink"
        }
      },
      "response_translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add AttachmentLink Parser"
      },
      "active": true,
      "notify_request": true,
      "notify_response": true
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get WO Entity Identifier",
      "queue": "primary",
      "translator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get WO Entity Identifier Parser"
      },
      "webhook": {
        "_reference": true,
        "method": "get",
        "resource": {
          "_reference": true,
          "namespace": "Cityworks",
          "name": "Get WorkOrderEntityIdentifier"
        }
      },
      "before_submit": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "before_submit_get_wo_entity_identifier"
      },
      "after_process_callbacks": [
        {
          "_reference": true,
          "namespace": "Citiworks",
          "name": "after_process_get_wo_entity_identifier"
        }
      ],
      "active": true,
      "notify_request": true,
      "notify_response": true,
      "discard_events": false
    }
  ],
  "translators": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Create WorkOrder Template",
      "type": "Export",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create_WorkOrder_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Create WorkOrder Parse",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create_WorkOrder_Parse.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Get CaseDetails by Task Parser",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_CaseDetails_by_Task_Parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Get Case Documents Parser",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_Case_Documents_Parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Set Task Status Template",
      "type": "Export",
      "bulk_source": true,
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Set_Task_Status_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Add Comment Parse",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Comment"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add_Comment_Parse.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Update Document Template",
      "type": "Export",
      "bulk_source": true,
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Update_Document_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Update task template",
      "type": "Export",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Updae_task_template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Get Document by Id Parse",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_Document_by_Id_Parse.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Check respnse parser",
      "type": "Import",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Check_respnse_parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Create Task Template",
      "type": "Export",
      "mime_type": "application/json",
      "file_extension": "json",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create_Task_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Create Task Check response parser",
      "type": "Import",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create_Task_Check_response_parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Get WorkOrder Documents Parse",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_WorkOrder_Documents_Parse.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Update Document Parser",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Update_Document_Parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Get User Template",
      "type": "Export",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "User"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_User_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Get User Parser",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "User"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_User_Parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Add Document case translator",
      "type": "Export",
      "mime_type": "multipart/form-data",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add_Document_case_translator.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Add Document to case parser",
      "type": "Import",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add_Document_to_case_parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Search Case Contractor Parse",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Search_Case_Contractor_Parse.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Add Document to WorkOrder Parse",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add_Document_to_WorkOrder_Parse.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Delete Task Template",
      "type": "Export",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Delete_Task_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyTemplate",
      "namespace": "Cityworks",
      "name": "Add AttachmentLink Template",
      "type": "Export",
      "mime_type": "application/json",
      "file_extension": "json",
      "source_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add_AttachmentLink_Template.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Add AttachmentLink Parser",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add_AttachmentLink_Parser.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::RubyParser",
      "namespace": "Cityworks",
      "name": "Get WO Entity Identifier Parser",
      "type": "Import",
      "target_data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder"
      },
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get_WO_Entity_Identifier_Parser.rb"
      }
    }
  ],
  "events": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Observer",
      "namespace": "Cityworks",
      "name": "New Route to EPR Event",
      "triggers": "{\"created_at\":[{\"o\":\"_not_null\",\"v\":[\"\",\"\",\"\"]}],\"eventName\":[{\"o\":\"is\",\"v\":\"Route to EPR\"}]}",
      "data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Action Manager Events"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Observer",
      "namespace": "Cityworks",
      "name": "work_order_created",
      "triggers": "{\"created_at\":[{\"o\":\"_not_null\",\"v\":[\"\",\"\",\"\"]}],\"WorkOrderSid\":[{\"o\":\"_null\",\"v\":\"\"}]}",
      "data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Observer",
      "namespace": "Cityworks",
      "name": "create_document",
      "data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "trigger_evaluator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_document_evaluator"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Observer",
      "namespace": "Cityworks",
      "name": "new_case_document_created",
      "data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "trigger_evaluator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "new_case_document_created_evaluator"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Observer",
      "namespace": "Cityworks",
      "name": "new_workorder_document_created",
      "data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document"
      },
      "trigger_evaluator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "new_workorder_document_created_evaluator"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Observer",
      "namespace": "Cityworks",
      "name": "create_comment_event",
      "data_type": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Action Manager Events"
      },
      "trigger_evaluator": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_comment_event_evaluator"
      }
    }
  ],
  "algorithms": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "refresh_token",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "refresh_token.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "type": "string",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_document",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_document.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "doc_id",
          "type": "integer",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "set_authorization",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "set_authorization.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "refresh_token",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "refresh_token"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_workorder_document_content",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_workorder_document_content.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "type": "hash",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks - Laserfiche",
      "name": "action_filter_result",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks - Laserfiche",
        "name": "action_filter_result.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "control",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "request_controller",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "request_controller.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "control",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_event",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_event.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "control",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "case_ids",
          "type": "string",
          "many": true,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_documents",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_documents.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "case_id",
          "type": "integer",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_addresses",
      "tags": "[]",
      "description": "this algorithm receives as params algorithm the strucutre:\r\n  params = { \r\n   \"CaObjectId\": null,\r\n    \"StreetNumber\": null,\r\n    \"StreetName\": null,\r\n    \"Suite\": null,\r\n    \"CityName\": null,\r\n    \"StateCode\": null,\r\n    \"StateName\": null,\r\n    \"ZipCode\": null\r\n     }",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_addresses.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "type": "hash",
          "many": false,
          "required": false,
          "default": "{}"
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_people",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_people.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "case_id",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_list",
      "tags": "[]",
      "description": "Example\r\ndata={\r\n    \"CaObjectId\": null,\r\n    \"BusinessName\": null,\r\n    \"Location\": null,\r\n    \"CaseName\": null,\r\n    \"CaseNumber\": null,\r\n    \"CaseStatusId\": null,\r\n    \"CaseStatus\": null,\r\n    \"CaseTypeId\": null,\r\n    \"CaseType\": null,\r\n    \"CaseTypeDesc\": null,\r\n    \"IssuedBy\": null,\r\n    \"IssuedFlag\": null,\r\n    \"ProjectId\": null,\r\n    \"ProjectCode\": null,\r\n    \"ProjectDesc\": null,\r\n    \"StatusCode\": null,\r\n    \"SubTypeId\": null,\r\n    \"SubType\": null,\r\n    \"SubTypeDesc\": null,\r\n    \"DateEnteredFrom\": null,\r\n    \"DateEnteredTo\": null,\r\n    \"Facility_Id\": null,\r\n    \"Level_Id\": null\r\n}",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_list.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "type": "hash",
          "many": false,
          "required": false,
          "default": "{}"
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_list_object",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_list_object.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_case_document",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 3,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_case_document.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "case_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "file_id",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_authorization",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_authorization.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_contractors",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_contractors.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "case_id",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_work_order_by_id",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_work_order_by_id.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "work_order_id",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_work_order",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_work_order.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "validate_authorization",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "validate_authorization.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_comment_by_status",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_comment_by_status.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_comment_by_worker_id",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_comment_by_worker_id.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_comment_by_worker_id",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_comment_by_worker_id.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "params"
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_entity_types",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_entity_types.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_entity_codes",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_entity_codes.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "get_designer_domains",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "get_designer_domains"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_templates_by_entity_type",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_templates_by_entity_type.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_designer_domains",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_designer_domains.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "do_actions_after_authorize",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "do_actions_after_authorize.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        },
        {
          "_primary": [
            "name"
          ],
          "name": "get_entity_codes",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "get_entity_codes"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_details_by_task_before_submit",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_details_by_task_before_submit.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_documents_before_submit",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_documents_before_submit.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_corrections_by_taskids",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_corrections_by_taskids.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_users",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_users.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_task_by_taskids",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_case_task_by_taskids.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_task_by_case",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_task_by_case.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_workorder_after_callback",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_workorder_after_callback.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_comment_template",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "add_comment_template.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_task_by_case",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_task_by_case(1).rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "duplicate_tasks",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 5,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "duplicate_tasks.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "start_point",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "end_point",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "taskId",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "caseId",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "update_task",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "update_task.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_entity_to_work_order",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "add_entity_to_work_order.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_entity",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_entity.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": false
        },
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": false
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "enable_next_task_available",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 3,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "enable_next_task_available.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "caseId",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "taskId",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "event",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "after_process_update_task",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "after_process_update_task.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "parsing_data",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "parsing_data.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "record",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "calculate_mappings",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "calculate_mappings.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "parsing_data",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "parsing_data"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_document_by_id_template",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_document_by_id_template.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "approved_deliverable_enable_next_task",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 4,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "approved_deliverable_enable_next_task.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "case_id",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "taskId",
          "type": "string",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "event",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "check_flow_response",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "check_flow_response.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_task_check_flow_response",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_task_check_flow_response(2).rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_workorder_documents_template",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_workorder_documents_template.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks - Bluebeam Studio",
      "name": "create_event_log",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 5,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks - Bluebealm Studio",
        "name": "create_event_log.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "case_number",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "event_name",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "flow_executed",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "response",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "event_id",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_document_evaluator",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks - Bluebeam Studio",
        "name": "create_document_evaluator(1).rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "current",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "previous",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_contractor_types",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "get_contractor_types.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "auth_id",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "search_case_contractor_template",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "search_case_contractor_template.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "new_case_document_created_evaluator",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "new_case_document_created_evaluator.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "current",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "previous",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "new_workorder_document_created_evaluator",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "new_workorder_document_created_evaluator.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "current",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "previous",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_document_to_workorder_template",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "add_document_to_workorder_template.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ],
      "call_links": [
        {
          "_primary": [
            "name"
          ],
          "name": "set_authorization",
          "link": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "set_authorization"
          }
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "before_submit_get_wo_entity_identifier",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "before_submit_get_wo_entity_identifier.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "options",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Citiworks",
      "name": "after_process_get_wo_entity_identifier",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Citiworks",
        "name": "after_process_get_wo_entity_identifier.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "task",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_comment_event_evaluator",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "create_comment_event_evaluator.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "current",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "previous",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_comment",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "add_comment.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "delete_comment",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "delete_comment.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "update_comment",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 1,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "update_comment.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "data",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "action_manager_events_controller",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "action_manager_events_controller.rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "controller",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "params",
          "many": false,
          "required": true
        }
      ]
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Test",
      "name": "test_app",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 0,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Test",
        "name": "test_app.rb"
      }
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks - Bluebeam Studio",
      "name": "create_document_evaluator",
      "tags": "[]",
      "store_output": false,
      "validate_output": false,
      "parameters_size": 2,
      "language": "ruby",
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks - Bluebeam Studio",
        "name": "create_document_evaluator(1).rb"
      },
      "parameters": [
        {
          "_primary": [
            "name"
          ],
          "name": "current",
          "many": false,
          "required": true
        },
        {
          "_primary": [
            "name"
          ],
          "name": "previous",
          "many": false,
          "required": true
        }
      ]
    }
  ],
  "applications": [
    {
      "_primary": [
        "namespace",
        "name",
        "_type"
      ],
      "namespace": "Cityworks",
      "name": "cityworks",
      "actions": [
        {
          "_primary": [
            "method",
            "path"
          ],
          "method": "get",
          "path": "/:_resource/:_action",
          "priority": 0,
          "algorithm": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "request_controller"
          }
        },
        {
          "_primary": [
            "method",
            "path"
          ],
          "method": "post",
          "path": "/:_resource/:_action",
          "priority": 0,
          "algorithm": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "request_controller"
          }
        },
        {
          "_primary": [
            "method",
            "path"
          ],
          "method": "get",
          "path": "/laserfishe_weblink/:wo_id/:entity_id/:entity_type",
          "priority": 0,
          "algorithm": {
            "_reference": true,
            "namespace": "Cityworks - Laserfiche",
            "name": "action_filter_result"
          }
        },
        {
          "_primary": [
            "method",
            "path"
          ],
          "method": "get",
          "path": "/test",
          "priority": 0,
          "algorithm": {
            "_reference": true,
            "namespace": "Test",
            "name": "test_app"
          }
        }
      ],
      "configuration": {
        "authentication_method": "Application ID",
        "redirect_uris": [
          "https://connect.velosimo.io/oauth/callback"
        ],
        "logo": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaQAAAGkAQMAAABEgsN2AAAABlBMVEXJulTw8PCRXR6CAAAA0ElEQVR4nO3cuw3CMBAGYAgNHSPAJrAZGQ02IRtABwWPJueCyCiKwkv+rrT9Wdf+ucjVfUAdq8mQoiiKoqjCVDN9rti+dHY2X+mQoiiKoiiKoiiKonIqEuv8hVrGR+M6e/sijuxG75CiKIqiKIqiKIoqU6U5bJ09d+ozh43Eeh69Q4qiKIqiKIqiKIrKqT5z2FTrNrreYmEWYfbwvg4piqIoiqIoiqKowtW+ja5p9RphdtVV/iWmKIqiKIqiKIqi/k5t888r/kiHFEVRFPVp9QCsq5YF228REgAAAABJRU5ErkJggg=="
      }
    }
  ],
  "snippets": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Action_Manager_Events.json",
      "type": "javascript",
      "code": "{\n  \"$schema\": \"http://json-schema.org/draft-07/schema\",\n  \"type\": \"object\",\n  \"title\": \"Action Manager Events\",\n  \"description\": \"An explanation about the purpose of this instance.\",\n  \"default\": null,\n  \"required\": [\n    \"objectId\"\n  ],\n  \"additionalProperties\": false,\n  \"properties\": {\n    \"objectId\": {\n      \"type\": \"string\"\n    },\n    \"objectNumber\": {\n      \"type\": \"string\"\n    },\n    \"eventName\": {\n      \"description\": \"The name of the event\",\n      \"type\": \"string\"\n    },\n    \"eventData\": {\n      \"description\": \"The data from the event\",\n      \"type\": \"object\"\n    },\n    \"description\": {\n      \"description\": \"Case description {task_id: description to show}\",\n      \"type\": \"object\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "refresh_token.rb",
      "type": "ruby",
      "code": "auth = Setup::Authorization.where(id: auth_id).first\r\nCenit.fail \"Authorization with ID: #{auth_id} not found\" unless auth\r\nauth_setting = Cenit.namespace('VCAv1').data_type('Authorizations Settings').where(auth_id: auth_id).first\r\nCenit.fail \"Setting for Authorization with ID: #{auth_id} not found\" unless auth_setting\r\ntime_zone = '-08:00'\r\nif Tenant.current.time_zone\r\n  time_zone = Tenant.current.time_zone.split(' | ').last\r\nend\r\n\r\nexpired = auth_setting[:configuration][:token].nil?\r\nunless expired\r\n  authenticated_at = DateTime.parse(auth_setting[:configuration][:authenticated_at])\r\n  expires = auth_setting[:configuration][:expires].split('.')\r\n  expired_at = authenticated_at + expires.first.to_i.try!(expires.last)\r\n  expired = Time.now.getlocal(time_zone) - 1.minutes > expired_at\r\nend\r\n\r\nif expired\r\n  authenticated_at = Time.now.getlocal(time_zone)\r\n  expires = auth_setting[:configuration][:expires].split('.')\r\n  expired_at = authenticated_at + expires.first.to_i.try!(expires.last)\r\n  data = {\r\n    \"LoginName\": \"#{auth.username}\",\r\n    \"Password\": \"#{auth.password}\",\r\n    \"Expires\": (expired_at - authenticated_at).in_milliseconds\r\n  }.to_json\r\n  conn = Cenit.namespace('Cityworks').connection('Cityworks API')\r\n  response = Cenit.namespace('Cityworks').resource('Authenticate').with(conn).get(parameters: { 'data' => data },\r\n                                                                       template_parameters: { 'instance' => auth_setting[:configuration][:instance] }\r\n  )\r\n  response = JSON.parse(response)\r\n  Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n  auth_setting[:configuration] = auth_setting[:configuration].merge({\r\n                                                                      \"token\": response['Value']['Token'],\r\n                                                                      \"authenticated_at\": authenticated_at.to_s\r\n                                                                    })\r\n  auth_setting.save\r\nend\r\n\r\nauth_setting[:configuration][:token]"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_document.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\r\n  \"CaRelDocsId\" => doc_id.to_i\r\n  }.to_json\r\n\r\n  response = Cenit.namespace('Cityworks').resource('CaseRelDocs Download').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\nreturn response\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "set_authorization.rb",
      "type": "ruby",
      "code": "token = refresh_token(auth_id)\r\nauth_setting = Cenit.namespace('VCAv1').data_type('Authorizations Settings').where(auth_id: auth_id).first\r\nconnection = Cenit.namespace('Cityworks').connection('Cityworks API')\r\n\r\nconn_tps = connection.template_parameters\r\ninstance = conn_tps.where(key: 'instance').first\r\ninstance.value = auth_setting[:configuration][\"instance\"]\r\ninstance.save\r\n\r\n{\r\n  \"connection\" => connection,\r\n  \"authorization\" => {\r\n    \"token\" => token\r\n  }\r\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "WorkOrder.json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"WorkOrderId\": {\n      \"type\": \"string\"\n    },\n    \"WorkOrderSid\": {\n      \"type\": \"string\"\n    },\n    \"EntityType\": {\n      \"type\": \"string\"\n    },\n    \"Status\": {\n      \"type\": \"string\"\n    },\n    \"source\": {\n      \"type\": \"string\"\n    },\n    \"Comments\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"$ref\": \"Comment\"\n      }\n    },\n    \"EntityUid\": {\n      \"type\": \"string\"\n    },\n    \"WOTemplateId\": {\n      \"type\": \"string\"\n    },\n    \"GeocodeAddress\": {\n      \"type\": \"boolean\"\n    },\n    \"X\": {\n      \"type\": \"number\"\n    },\n    \"Y\": {\n      \"type\": \"number\"\n    },\n    \"Z\": {\n      \"type\": \"number\"\n    },\n    \"Address\": {\n      \"type\": \"string\"\n    },\n    \"City\": {\n      \"type\": \"string\"\n    },\n    \"ActivityZone\": {\n      \"type\": \"string\"\n    },\n    \"Location\": {\n      \"type\": \"string\"\n    },\n    \"StreetName\": {\n      \"type\": \"string\"\n    },\n    \"Zip\": {\n      \"type\": \"string\"\n    },\n    \"DomainId\": {\n      \"type\": \"number\"\n    },\n    \"AssetId\": {\n      \"type\": \"string\"\n    },\n    \"OBJECTID\": {\n      \"type\": \"string\"\n    },\n    \"AssetGroup\": {\n      \"type\": \"string\"\n    },\n    \"ApplyToEntity\": {\n      \"type\": \"string\"\n    },\n    \"Supervisor\": {\n      \"type\": \"string\"\n    },\n    \"Description\": {\n      \"type\": \"string\"\n    },\n    \"InitiatedBy\": {\n      \"type\": \"string\"\n    },\n    \"InitiateDate\": {\n      \"type\": \"string\"\n    },\n    \"IsReactive\": {\n      \"type\": \"boolean\"\n    },\n    \"auth_id\": {\n      \"type\": \"string\"\n    },\n    \"metadata\": {\n      \"type\": \"object\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Document.json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"docId\": {\n      \"type\": \"string\"\n    },\n    \"name\": {\n      \"type\": \"string\"\n    },\n    \"objectType\": {\n      \"type\": \"string\"\n    },\n    \"objectId\": {\n      \"type\": \"string\"\n    },\n    \"eventId\": {\n      \"type\": \"string\"\n    },\n    \"source\": {\n      \"type\": \"string\"\n    },\n    \"url\": {\n      \"type\": \"string\"\n    },\n    \"labelText\": {\n      \"type\": \"string\"\n    },\n    \"tags\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      }\n    },\n    \"type_of_document\": {\n      \"type\": \"string\"\n    },\n    \"auth_id\": {\n      \"type\": \"string\"\n    },\n    \"metadata\": {\n      \"type\": \"object\"\n    },\n    \"attachment\": {\n      \"$ref\": \"Attachment\",\n      \"referenced\": true\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Comment.json",
      "type": "javascript",
      "code": "{\n  \"title\": \"Comment\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"commentId\": {\n      \"type\": \"string\"\n    },\n    \"comment\": {\n      \"type\": \"string\"\n    },\n    \"activitySid\": {\n      \"type\": \"string\"\n    },\n    \"source\": {\n      \"type\": \"string\"\n    },\n    \"state\": {\n      \"type\": \"string\",\n      \"description\": \"Current for existing comments and To Add, To Delete and To Update for other actions\"\n    },\n    \"metadata\": {\n      \"type\": \"object\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_workorder_document_content.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Requesting Cityworks #{params['docId']} Workorder Document\", type: :info)\r\n\r\nbegin\r\n  response = {}\r\n\r\n  cityworks_np = Cenit.namespace('Cityworks')\r\n\r\n  cityworks_np.resource('Download WorkOrder Document').get(\r\n    template_parameters: {\r\n      'token'=> params['token'],\r\n      'data' => {\"AttachmentId\": params['attachmentId']}.to_json\r\n      }\r\n    )do |result|\r\n      response['StatusCode'] = result.code\r\n\r\n      if result.code.eql?(200)\r\n        response['Data'] = result.body\r\n      else\r\n        if result.code.eql?(404)\r\n          response['StatusDescription'] = 'Document not found'\r\n        else\r\n          response['StatusDescription'] = \"ERROR requesting document\"\r\n        end\r\n      end\r\n    end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error requesting Cityworks #{params['docId']} Workorder Document: #{ex.message}\")\r\n\r\n  response['StatusCode'] = 500\r\n  response['StatusDescription'] = \"Error requesting Cityworks #{params['docId']} Workorder Document: #{ex.message}\"\r\nend\r\n\r\nresponse\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks - Laserfiche",
      "name": "action_filter_result.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"CW - LS app params: #{params.to_json}\")\r\n\r\nns = Velosimo.namespace(\"Laserfiche\")\r\nns_cw = Velosimo.namespace(\"Cityworks\")\r\nns_cw_ls = Velosimo.namespace(\"Cityworks - Laserfiche\")\r\n\r\nget_auth_alg = ns.algorithm(:set_authorization)\r\nget_files_alg = ns.algorithm(:get_files)\r\nget_fields = ns.algorithm(:get_fields)\r\n\r\nauthorization = Velosimo.namespace('Setup').data_type('Authorization').where(name: \"Laserfiche\").first\r\nauth_response = get_auth_alg.run({\"auth_id\"=> authorization.id})\r\n\r\n\r\nwo = ns_cw.data_type(\"WorkOrder\").where(WorkOrderId: params[:wo_id]).first\r\nsetting_id = wo.metadata[\"setting_id\"]\r\nsetting = ns_cw_ls.data_type(\"Setting\").where(id: setting_id).first\r\n\r\npath = setting.base_folder#\"/DEMO/Agency Docs/As-Builts\"\r\nasset_id = \"#{params[:entity_id]}\"\r\nasset_type = \"#{params[:entity_type]}\"\r\n\r\nfiles_response = get_files_alg.run({\r\n  'connection'=> auth_response['Data']['connection'],\r\n  'folder'=> path, \r\n  'searchFields'=> [\r\n   {\r\n    \"fieldId\"=> setting.weblikn_query_setting[\"fields\"][\"ASSET_ID\"],#\"364\",\r\n    \"fieldName\"=> \"ASSET ID\",\r\n    \"fieldType\"=> \"String\",\r\n    \"fieldLength\"=> 40,\r\n    \"isAssigned\"=> true,\r\n    \"isMultiValue\"=> false,\r\n     \"fieldValue\"=> asset_id\r\n    }, {\r\n    \"fieldId\"=> setting.weblikn_query_setting[\"fields\"][\"ASSET_TYPE\"],#\"366\",\r\n    \"fieldName\"=> \"ASSET TYPE\",\r\n    \"fieldType\"=> \"String\",\r\n    \"fieldLength\"=> 40,\r\n    \"isAssigned\"=> true,\r\n    \"isMultiValue\"=> false,\r\n    \"fieldValue\"=> asset_type\r\n    }].to_json\r\n  })\r\n\r\nquery_result = files_response[\"Data\"][\"Documents\"].map do |x|\r\n  {\r\n    id: x[\"Id\"],\r\n    name: x[\"Name\"],\r\n    path: x[\"Path\"],\r\n    link: \"http://laserfiche.velosimo.com/WebLink/DocView.aspx?id=#{x[\"Id\"]}&dbid=0&repo=velosimo&cr=1\",\r\n    created: x[\"CreatedDate\"]\r\n  }\r\nend\r\n\r\n#return query_result\r\ncontrol.render html: control.render_template(\"Cityworks - Laserfiche::laserfishe_documents_query_result\", data: {\"asset_id\" => asset_id, \"asset_type\" => asset_type, \"query_result\" => query_result})"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "request_controller.rb",
      "type": "ruby",
      "code": "begin\r\n  \r\n   Tenant.notify(message: \"Cityworks request_controller: #{params.to_json}.\", type: \"notice\")\r\n\r\n  \r\n  action = params[:_action]\r\n  resource = params[:_resource]\r\n\r\n  #tenant = Tenant.data_type.where(id: params['_tenant_id']).first\r\n  response = {}\r\n  #tenant.switch do\r\n  algorithm = control.algorithm(\"#{action}_#{resource}\")\r\n  response = algorithm.run([control, params])\r\n  #end\r\n\r\n  unless control.done?\r\n    if params[:format] == 'yaml'\r\n      control.render :text => response.to_yaml, :content_type => 'text/yaml', status: response[:code] || 200\r\n    else\r\n      control.render json: response, status: response[:code] || 200\r\n    end\r\n  end\r\nrescue StandardError => ex\r\n  code = ex.message =~ /^\\[(\\d+)\\]/ ? $1.to_i : 200\r\n  message = ex.message.gsub(/^\\[(\\d+)\\] - /, '')\r\n  control.render json: { message: message }, status: code\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_event.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Cityworks create_event webhook: #{params.to_json}.\", type: \"notice\")\r\nrequest = control.try(:controller).request\r\nrequest.body.rewind\r\nbody = JSON.parse(request.body.read)\r\n\r\nns = Velosimo.namespace(\"Cityworks\")\r\nauth_id = ns.authorization(\"Cityworks\").id\r\nns.algorithm(:refresh_token).run(auth_id)\r\n\r\nTenant.notify(message: \"auth_id: #{auth_id}.\", type: \"notice\")\r\n\r\n\r\nbody[\"auth_id\"] = auth_id.to_s\r\nTenant.notify(message: \"body: #{body.to_json}.\", type: \"notice\")\r\n\r\ndata = {\r\n  objectId: body.delete('objectId'),\r\n  objectNumber: body.delete('objectNumber'),\r\n  eventName: body.delete('eventName'),\r\n  eventData: body\r\n}\r\nTenant.notify(message: \"data: #{data.to_json}.\", type: \"notice\")\r\nres = control.data_type(\"Action Manager Events\").create_from_json(data.to_json)\r\n\r\nif res.errors.blank?\r\n  { :success => true }\r\nelse\r\n  { :code => 500, :success => false, :message => \"#{res.errors.full_messages.to_sentence}\" }\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\ndata = {\r\n  \"CaObjectIds\" => case_ids\r\n}.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  \r\n  response = Cenit.namespace('Cityworks').resource('CaseObject ByIds').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n\r\n  response = JSON.parse(response)\r\n  if response['Status'] ==  3\r\n    count = count + 1\r\n      run_again = true\r\n    else\r\n      run_again = false\r\n      if response['Status'] == 0\r\n        return response['Value'].first\r\n      else\r\n        return {'Code' => 500 }\r\n      end\r\n  end\r\n  \r\nend\r\n\r\n  "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_documents.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\r\n  \"CaObjectId\" => case_id\r\n}.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  response = Cenit.namespace('Cityworks').resource('CaseRelDocs ByCaObjectId').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n\r\n  response = JSON.parse(response)\r\n   if response['Status'] ==  3\r\n     count = count + 1\r\n      run_again = true\r\n    else\r\n      run_again = false\r\n     Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n     return response['files']\r\n   end\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_addresses.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  response = Cenit.namespace('Cityworks').resource('CaseAddress SearchObject').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => params, 'token' => authorization['authorization']['token'] }\r\n  )\r\n  response = JSON.parse(response)\r\n   if response['Status'] ==  3\r\n     count = count + 1\r\n      run_again = true\r\n    else\r\n      run_again = false\r\n     Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n     return response[\"Value\"].nil? ? nil : response[\"Value\"]\r\n   end\r\n  \r\nend\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_people.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\r\n  \"CaObjectId\": case_id\r\n  }.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  \r\n  conn = conn = Cenit.namespace('Cityworks').connection('Cityworks API')\r\n  response = Cenit.namespace('Cityworks').resource('Case getPeople').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n  response = JSON.parse(response)\r\n  if response['Status'] ==  3\r\n    count = count + 1\r\n    run_again = true\r\n    else\r\n      run_again = false\r\n      Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n      return response[\"Value\"]\r\n  end\r\nend\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_list.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Cityworks get_case_list #{auth_id} data: #{data.to_json}\", type: \"notice\")\r\ncw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = data.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  \r\n  response = Cenit.namespace('Cityworks').resource('CaseObject Search').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n\r\n  response = JSON.parse(response)\r\n   if response['Status'] ==  3\r\n     count = count + 1\r\n      run_again = true\r\n    else\r\n      run_again = false\r\n     Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n     return response['Value']\r\n   end\r\n  \r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_list_object.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"CW:get_case_list_object #{auth_id}\", type: \"info\")\r\n\r\ncw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\n\r\n  data = {\r\n    \"CaObjectIds\" => []\r\n  }.to_json\r\n\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  response = Cenit.namespace('Cityworks').resource('CaseObject ByIds').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n  response = JSON.parse(response)\r\n  if response['Status'] ==  3\r\n    count = count + 1\r\n      run_again = true\r\n    else\r\n      run_again = false\r\n     Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n\r\n    return response['Value']\r\n  end\r\n \r\nend\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_case_document.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\nfile = Cenit.namespace('Cityworks - DocuSign').data_type('File').where(id: file_id).first\r\ndata = {\r\n  \"CaObjectId\" => case_id\r\n}.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  response = Cenit.namespace('Cityworks').resource('CaseRelDocs Add').with(authorization['connection']).post(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] },\r\n    body: {'file' => file.attachment}\r\n  )\r\n  response = JSON.parse(response)\r\n   if response['Status'] ==  3\r\n     count = count + 1\r\n      run_again = true\r\n    else\r\n      run_again = false\r\n     Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n     return response\r\n   end\r\nend\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_authorization.rb",
      "type": "ruby",
      "code": " begin\r\n  \r\n  auths ||= Cenit.namespace('Setup').data_type('Authorization').where(namespace: \"Cityworks\")\r\n\r\n  result = []\r\n   if auths\r\n     result = auths.map{|x| [x.id.to_s, {name: x.name, authorized: x.authorized? }]}.to_h     \r\n   end\r\n  \r\n   return { \r\n      \"StatusCode\"=> 200, \r\n     \"Data\"=> result\r\n     }\r\n\r\nrescue StandardError => error\r\n  return { \"StatusCode\"=> 500, \"StatusDescription\"=> error.message }\r\nend\r\n            \r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_contractors.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\r\n  \"CaObjectId\": case_id\r\n  }.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n  response = Cenit.namespace('Cityworks').resource('CaseContractor').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n  response = JSON.parse(response)\r\n   if response['Status'] ==  3\r\n     count = count + 1\r\n     run_again = true\r\n  else\r\n    run_again = false\r\n     Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n     return response[\"Value\"]\r\n   end\r\n  \r\nend\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_work_order_by_id.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\r\n  \"WorkOrderId\": work_order_id \r\n  }.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3  \r\n  response = Cenit.namespace('Cityworks').resource('Work order ById').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n  response = JSON.parse(response)\r\n  if response['Status'] ==  3\r\n    count = count + 1\r\n    run_again = true\r\n  else\r\n    run_again = false\r\n    Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n    return response[\"Value\"]\r\n  end\r\n  \r\nend\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_work_order.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = data.to_json\r\nconn = Cenit.namespace('Cityworks').connection('Cityworks API')\r\nresponse = Cenit.namespace('Cityworks').resource('Create WorkOrder').with(authorization['connection']).post(\r\n  template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n)\r\nresponse = JSON.parse(response)\r\nCenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\nresponse"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "validate_authorization.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Check Authorization for Cityworks #{params.to_json}\", type: :info)\r\n\r\nbegin\r\n  auth_id = params[:authorization]\r\n  \r\n  auth = Setup::Authorization.where(id: auth_id).first\r\n  Tenant.notify(message: \"Authorization with ID: #{auth_id} not found\") unless auth\r\n  return {\"StatusCode\"=> 500,\"StatusDescription\"=> \"Authorization with ID: #{auth_id} not found\"} unless auth\r\n  \r\n  auth_setting = Cenit.namespace('VCAv1').data_type('Authorizations Settings').where(auth_id: auth_id).first\r\n  Tenant.notify(message: \"Setting for Authorization with ID: #{auth_id} not found\") unless auth_setting\r\n  return {\"StatusCode\"=> 500, \"StatusDescription\"=> \"Setting for Authorization with ID: #{auth_id} not found\"} unless auth_setting\r\n    \r\n  \r\n  time_zone = '-08:00'\r\n  if Tenant.current.time_zone\r\n    time_zone = Tenant.current.time_zone.split(' | ').last\r\n  end\r\n  \r\n  authenticated_at = Time.now.getlocal(time_zone)\r\n  expires = auth_setting[:configuration][:expires].split('.')\r\n  expired_at = authenticated_at + expires.first.to_i.try!(expires.last)\r\n  \r\n  data = {\r\n    \"LoginName\": \"#{auth.username}\",\r\n    \"Password\": \"#{auth.password}\",\r\n    \"Expires\": (expired_at - authenticated_at).in_milliseconds\r\n  }.to_json\r\n  conn = Cenit.namespace('Cityworks').connection('Cityworks API')\r\n  response = Cenit.namespace('Cityworks').resource('Authenticate').with(conn).get(parameters: { 'data' => data },\r\n                                                                       template_parameters: { 'instance' => auth_setting[:configuration][:instance] }\r\n  )\r\n  response = JSON.parse(response)\r\n  \r\n  if response['Status'] !=  0    \r\n    Tenant.notify(message: \"Error on Cityworks Authorization #{response['Message']}\" )\r\n    return {\"StatusCode\"=> 500,\"StatusDescription\"=> response['Message']}    \r\n  else    \r\n    auth_setting[:configuration] = auth_setting[:configuration].merge({\r\n                                                                      \"token\": response['Value']['Token'],\r\n                                                                      \"authenticated_at\": authenticated_at.to_s\r\n                                                                    })\r\n    auth_setting.save\r\n    return {\"StatusCode\"=> 200,\"StatusDescription\"=> \"SUCCESS\"}    \r\n  end  \r\n  \r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error on Cityworks Authorization\")\r\n  return {\"StatusCode\"=> 500,\"StatusDescription\"=> \"Error on Cityworks Authorization #{ex.message}\"} \r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Create_WorkOrder_Template.rb",
      "type": "ruby",
      "code": " Tenant.notify(message: \"Creating WorkOrder\", type: \"notice\")\r\n\r\ntask.description = source['metadata']['description']\r\n\r\nauth_id = source[\"metadata\"][\"cw_auth\"]\r\nauthorization = Cenit.namespace('Cityworks').algorithm(:set_authorization).run(auth_id)\r\n\r\n\r\ncomments = []\r\n#source[\"Comments\"].each{|c| comments << c[\"Comment\"]}\r\n#comments = comments.join(\" - \")\r\nrequest_data = {\r\n  \"EntitySid\": source[\"OBJECTID\"],#[\"AssetId\"],#323,\r\n  \"FeatureId\": source[\"OBJECTID\"],#[\"AssetId\"],#323,\r\n  \"EntityUid\": source[\"EntityUid\"],#\"WELL-29\",\r\n  \"Location\": source[\"Location\"],\r\n  #\"EntityType\": source[\"EntityType\"],\r\n  \"WOTemplateId\": source[\"WOTemplateId\"],\r\n  #\"EntityUid\": source[\"EntityUid\"],\r\n  \"Reactive\": source[\"IsReactive\"].to_b,\r\n  \"RequestedBySid\": 17421, #change in the client\r\n  #\"RequestedBy\": \"(AD) Admin, PLL\", deprecated by CW API\r\n  \"InitiateDate\": source[\"InitiateDate\"],\r\n  #\"DateToBePrinted\": source[\"InitiateDate\"],\r\n  \"ProjStartDate\": source[\"InitiateDate\"],\r\n  \"DatePrinted\": source[\"InitiateDate\"],\r\n  #\"ProjFinishDate\": source[\"InitiateDate\"],\r\n  \"Description\": source[\"Description\"],\r\n  \"Status\": source[\"Status\"],\r\n  \"GeocodeAddress\": true,\r\n  \"Address\": source[\"Address\"]\r\n  #\"Comments\": comments\r\n  }\r\nTenant.notify(message: \"taget to create: #{request_data}\", type: \"notice\")\r\nrequest_data.keys.each do |k|\r\n   request_data.delete(k) if request_data[k].nil?      \r\nend\r\nparameters[\"data\"] = request_data.to_json\r\n#source.to_json\r\nparameters[\"token\"] = authorization['authorization']['token']\r\n#template_parameters[\"instance\"] = params_for_request['instance']\r\ntask.state[\"object_id\"] = source.id\r\ntask.state[\"auth_id\"] = auth_id\r\nnil\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Create_WorkOrder_Parse.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Create work order parser\", type: \"notice\")\r\n\r\ndata = JSON.parse(data)\r\ncw_ns = Velosimo.namespace(:Cityworks)\r\n\r\nif data[\"Status\"].present? and data[\"Status\"].eql?(3)\r\n  Velosimo.fail \"Create Work order failed\"\r\nend\r\n\r\nwork_order_id = data[\"Value\"][0][\"WorkOrderId\"]\r\nobj = target_data_type.where(id: task.state[\"object_id\"]).first\r\n\r\nobj.WorkOrderId = work_order_id\r\nobj.WorkOrderSid = data[\"Value\"][0][\"WorkOrderSid\"]\r\n\r\nTenant.notify(message: \"Cityworks work order created: #{obj.WorkOrderSid.to_s}\", type: \"notice\")\r\n\r\nobj.save\r\n\r\ntask.state[:source] = obj "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_comment_by_status.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\"ActivityTypes\": \"Update_Comment\"}.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n\r\n  response = Cenit.namespace('Cityworks').resource('Get Comments ByActivityTypes').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n  response = JSON.parse(response)\r\n  if response['Status'] == 3\r\n    count = count + 1\r\n    run_again = true\r\n   else\r\n    run_again = false\r\n    Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n    return response\r\n\r\n  end\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_comment_by_worker_id.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\nwork_order_id = data[:WorkOrderSid]\r\ndata = {\"ActivityType\": 2, \"ActivityIds\": [\"#{work_order_id}\"] }.to_json\r\n\r\nrun_again = true\r\ncount = 0\r\nwhile run_again and count < 3\r\n\r\n  response = Cenit.namespace('Cityworks').resource('Get Comment By Activity').with(authorization['connection']).get(\r\n    template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n  )\r\n\r\n  response = JSON.parse(response)\r\n  if response['Status'] == 3\r\n    count = count + 1\r\n    run_again = true\r\n   else\r\n    run_again = false\r\n    return { \"Code\": 200, \"Data\": response}\r\n\r\n    Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n\r\n   end\r\n  \r\nend\r\n    \r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_comment_by_worker_id.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace('Cityworks')\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ndata = {\r\n  \"ActivityType\": 2,#WorkOrder\r\n  \"ActivityIds\": [\"#{data[:WorkOrderSid]}\"],\r\n  }\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = Cenit.namespace('Cityworks').resource('Get Comment By Activity').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => data.to_json, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n     else\r\n      run_again = false\r\n      value_comment = response[\"Value\"].detect{|x,y| x == params[:WorkOrderSid]}\r\n\r\n      return { \"Code\": 200, \"Data\": value_comment}\r\n      Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n      \r\n    end\r\n  end\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_entity_types.rb",
      "type": "ruby",
      "code": "begin\r\n\r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  \r\n  codes = type_dt = cw_ns.data_type(\"Work Order Type\")\r\n  codes = codes.all\r\n  result = []\r\n\r\n  codes_ids = codes.map{|x| x[\"Module\"]}\r\n  data = {\r\n    \"EntityGroups\": codes_ids\r\n    }.to_json\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = Cenit.namespace('Cityworks').resource('Get Entity Types').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n     else\r\n      \r\n      run_again = false\r\n      \r\n      if response['Status'] == 0\r\n        result = []\r\n        response[\"Value\"].each do |v|\r\n          module_name = cw_ns.data_type(\"Work Order Type\").where(Module: v[\"Module\"]).first\r\n          module_name = module_name.ModuleName\r\n          v[\"Module\"] = module_name\r\n          result << v\r\n        end\r\n\r\n        return { \r\n          \"StatusCode\": 200,\r\n          \"Data\": result#response[\"Value\"]\r\n          }\r\n      else\r\n        Tenant.notify(message: \"Error Cityworks getting types #{response.to_json}\", type: \"error\")\r\n        return { \"StatusCode\": 500, \"StatusDescription\": \"Getting Cityworks Types: This might be caused retrieving the Cityworks authorization token, please retry this action.\"}\r\n      end\r\n    end\r\n    \r\n  end\r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error Cityworks getting types #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Getting Cityworks Types: This might be caused retrieving the Cityworks authorization token, please retry this action.\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_entity_codes.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Cityworks Get Codes\", type: \"notice\")\r\nbegin\r\n  \r\n  result = []\r\n  response = nil\r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  type_dt = cw_ns.data_type(\"Work Order Type\")\r\n  \r\n  if type_dt.all.count != 0\r\n    return { \"Code\": 200, \"Data\": type_dt.all.map{|x| x.to_json}}\r\n  end\r\n  \r\n  domains = get_designer_domains(auth_id)  \r\n  Cenit.fail \"Error getting Cityworks Domain petition\" if domains[:Code] != 200  \r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  \r\n  domains[:Data].each do |d|\r\n    data = {\r\n      \"DomainId\": d[\"DomainId\"].to_s\r\n      }.to_json\r\n\r\n    run_again = true\r\n  \tcount = 0\r\n    while run_again and count < 3\r\n      \r\n      response = cw_ns.resource('Get Entity Group').with(authorization['connection']).get(\r\n        template_parameters: { 'data' => data, 'token' => authorization['authorization']['token'] }\r\n      )\r\n\r\n      response = JSON.parse(response)\r\n      if response['Status'] == 3\r\n        count = count + 1\r\n      \trun_again = true\r\n      else\r\n        result << response[\"Value\"]\r\n        response[\"Value\"].each{|x| type_dt.create_from_json!({\"DomainId\": d[\"DomainId\"].to_s, \"Module\": x[\"Module\"], \"ModuleName\": x[\"ModuleName\"]}, primary_field: [\"DomainId\", \"Module\"])}\r\n        run_again = false\r\n      end\r\n  \tend\r\n  end\r\n  \r\n  return { \"Code\": 200, \"Data\": result}\r\n  Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n  response\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error Cityworks getting codes #{ex.message}\", type: \"error\")\r\n   return { \"Code\": 500, \"StatusDescription\": \"Getting codes: This might be caused retrieving the Cityworks authorization token, please retry this action.\"}\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Work_Order_Type.json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"DomainId\": {\n      \"type\": \"string\"\n    },\n    \"Module\": {\n      \"type\": \"string\"\n    },\n    \"ModuleName\": {\n      \"type\": \"string\"\n    },\n    \"Code\": {\n      \"type\": \"string\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_templates_by_entity_type.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Getting templates of #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  req = {\r\n    \"EntityTypes\": [\"#{data}\"]\r\n     }.to_json\r\n  \r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = Cenit.namespace('Cityworks').resource('Get TemplateNames').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    elsif response['Status'] == 0\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": response[\"Value\"]\r\n        }\r\n    else\r\n      Tenant.notify(message: \"Error response Cityworks getting templates #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Getting Cityworks Templates: This might be caused retrieving the Cityworks authorization token, please retry this action.\"}\r\n    end\r\n  end\r\n\r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error Cityworks getting types #{ex.message}\", type: \"error\")\r\n   return { \"StatusCode\": 500, \"StatusDescription\": \"Getting Cityworks Templates: This might be caused retrieving the Cityworks authorization token, please retry this action.\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_designer_domains.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Cityworks Get Domains\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = cw_ns.resource('Get Designer Domains').with(authorization['connection']).get(\r\n      template_parameters: { 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    else\r\n      type_dt = Cenit.namespace(\"Cityworks\").data_type(\"Work Order Type\")\r\n      #response[\"Value\"].each{|x| type_dt.create_from_json!({\"DomainId\": x[\"DomainId\"]}, primary_field: \"DomainId\")}\r\n\r\n\t  Cenit.fail \"[#{response['Status']}] - #{response['Message']}\" unless response['Status'] == 0\r\n      return { \"Code\": 200, \"Data\": response[\"Value\"]}\r\n    end\r\n  end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error Cityworks getting domains #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Getting domains: This might be caused retrieving the Cityworks authorization token, please retry this action.\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "do_actions_after_authorize.rb",
      "type": "ruby",
      "code": " begin\r\n  response = {}\r\n  response['StatusDescription'] = []\r\n\r\n  auth_response = set_authorization(params['auth_id'])\r\n\r\n  codes_response = get_entity_codes(params['auth_id'])\r\n \r\n  if response['StatusDescription'].empty?\r\n    response['StatusCode'] = 200\r\n    response['StatusDescription'] = 'Success'\r\n  end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error running actions for Cityworks #{params['auth_id']} authorization: #{ex.message}\")\r\nend\r\n\r\nresponse\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Module.json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"DomainId\": {\n      \"type\": \"string\"\n    },\n    \"Module\": {\n      \"type\": \"string\"\n    },\n    \"ModuleName\": {\n      \"type\": \"string\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Service_Request.json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"Address\": {\n      \"type\": \"string\"\n    },\n    \"Answers\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"AnswerId\": {\n            \"type\": \"string\"\n          },\n          \"AnswerValue\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n    },\n    \"AptNum\": {\n      \"type\": \"string\"\n    },\n    \"CallerAcctNum\": {\n      \"type\": \"string\"\n    },\n    \"CallerAddress\": {\n      \"type\": \"string\"\n    },\n    \"CallerAddressType\": {\n      \"type\": \"string\"\n    },\n    \"CallerAptNum\": {\n      \"type\": \"string\"\n    },\n    \"CallerCallback\": {\n      \"type\": \"boolean\"\n    },\n    \"CallerCallbackTime\": {\n      \"type\": \"string\"\n    },\n    \"CallerCallTime\": {\n      \"type\": \"string\"\n    },\n    \"CallerCellPhone\": {\n      \"type\": \"string\"\n    },\n    \"CallerCity\": {\n      \"type\": \"string\"\n    },\n    \"CallerComments\": {\n      \"type\": \"string\"\n    },\n    \"CallerContact\": {\n      \"type\": \"boolean\"\n    },\n    \"CallerContactTime\": {\n      \"type\": \"string\"\n    },\n    \"CallerDistrict\": {\n      \"type\": \"string\"\n    },\n    \"CallerEmail\": {\n      \"type\": \"string\"\n    },\n    \"CallerFax\": {\n      \"type\": \"string\"\n    },\n    \"CallerFirstName\": {\n      \"type\": \"string\"\n    },\n    \"CallerHomePhone\": {\n      \"type\": \"string\"\n    },\n    \"CallerIsFollowUpCall\": {\n      \"type\": \"boolean\"\n    },\n    \"CallerIsOwner\": {\n      \"type\": \"boolean\"\n    },\n    \"CallerLastName\": {\n      \"type\": \"string\"\n    },\n    \"CallerMiddleInitial\": {\n      \"type\": \"string\"\n    },\n    \"CallerOtherPhone\": {\n      \"type\": \"string\"\n    },\n    \"CallerState\": {\n      \"type\": \"string\"\n    },\n    \"CallerText1\": {\n      \"type\": \"string\"\n    },\n    \"CallerText2\": {\n      \"type\": \"string\"\n    },\n    \"CallerText3\": {\n      \"type\": \"string\"\n    },\n    \"CallerText4\": {\n      \"type\": \"string\"\n    },\n    \"CallerText5\": {\n      \"type\": \"string\"\n    },\n    \"CallerTitle\": {\n      \"type\": \"string\"\n    },\n    \"CallerType\": {\n      \"type\": \"string\"\n    },\n    \"CallerWorkPhone\": {\n      \"type\": \"string\"\n    },\n    \"CallerZip\": {\n      \"type\": \"string\"\n    },\n    \"CaseIds\": {\n      \"type\": \"array\",\n      \"description\": \"Link request to cases\"\n    },\n    \"City\": {\n      \"type\": \"string\"\n    },\n    \"Comments\": {\n      \"type\": \"string\"\n    },\n    \"CustomFieldValues\": {\n      \"type\": \"string\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Case(1).json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"CaObjectId\": {\n      \"type\": \"string\"\n    },\n    \"CaseNumber\": {\n      \"type\": \"string\"\n    },\n    \"Tasks\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"CaTaskId\": {\n            \"type\": \"string\"\n          },\n          \"TaskId\": {\n            \"type\": \"string\"\n          },\n          \"TaskCode\": {\n            \"type\": \"string\"\n          },\n          \"TaskDesc\": {\n            \"type\": \"string\"\n          },\n          \"ResultSetId\": {\n            \"type\": \"string\"\n          },\n          \"ResultCode\": {\n            \"type\": \"string\"\n          },\n          \"ResultDisplay\": {\n            \"type\": \"string\"\n          },\n          \"TaskType\": {\n            \"type\": \"string\"\n          },\n          \"CaseStatus\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n    },\n    \"Documents\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"url\": {\n            \"type\": \"string\"\n          },\n          \"Tags\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"string\"\n            }\n          }\n        }\n      }\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_CaseDetails_by_Task_Parser.rb",
      "type": "ruby",
      "code": " Tenant.notify(message: \"Get CaseDetails by Task Parser\", type: \"info\")\r\n\r\ndata = JSON.parse(data)\r\ncw_ns = Cenit.namespace(:Cityworks)\r\n\r\nif data[\"Status\"].present? and data[\"Status\"] == 3\r\n  Cenit.fail \"Get CaseDetails by Task Parser #{data.to_json}\"\r\nend\r\n\r\ntask = data[\"Value\"][0]\r\ntarget_task = task\r\ntarget_case = {\r\n  \"CaObjectId\": task[\"CaObjectId\"],\r\n  \"CaseNumber\": task[\"CaseNumber\"],\r\n  \"Tasks\": [target_task]\r\n  }\r\n\r\n#get CW documents\r\nauth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\ndocs = cw_ns.algorithm('get_case_documents').run([auth_id, task[\"CaObjectId\"]])\r\ntarget_case[\"Documents\"] = docs\r\n\r\ntarget_data_type.create_from_json!(target_case, primary_field: \"CaObjectId\")"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_details_by_task_before_submit.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Running: get_case_details_by_task_before_submit\", type: \"info\") \r\ncw_ns = Cenit.namespace('Cityworks')\r\nauth_id = cw_ns.authorization(\"Cityworks\").id\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\noptions[:connection] = cw_ns.connection(\"Cityworks API\")\r\noptions[:parameters][\"data\"] = {\"CaTaskIds\": [\"4193\"]}.to_json\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\n \r\n\r\n#join_task = task\r\n#flow.join_process({ object_ids: [order_created.id], connection: cnx }, join_task)"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_documents_before_submit.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Running: get_case_documents_before_submit #{task.to_json}\", type: \"info\") \r\n\r\nauthorization = Cenit.namespace('Cityworks').algorithm(:set_authorization).run(task[\"message\"][\"auth_id\"])\r\n\r\noptions[:connection] = Cenit.namespace('Cityworks').connection(\"Cityworks API\")\r\noptions[:parameters][\"data\"] = {\"CaObjectId\": task[\"message\"][\"caseId\"] }.to_json \r\n\r\ntask.state[\"metadata\"] = task[\"message\"][\"metadata\"]\r\ntask.state[\"source\"] = task[\"message\"][\"source\"]\r\ntask.state[\"auth_id\"] = task[\"message\"][\"auth_id\"]\r\ntask.state[\"event_id\"] = task[\"message\"][\"event_id\"]\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\n "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_Case_Documents_Parser.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Get Case Documents Parser #{task.state.to_json}\", type: \"info\")\r\n\r\ntask.description = task.state[\"metadata\"][\"description\"]\r\ndata = JSON.parse(data)\r\ncount = 0\r\n\r\nif data[\"Status\"].present? \r\n\r\n  case data[\"Status\"]\r\n  when 3\r\n    count ++\r\n    task.run_again unless count > 4\r\n\r\n  when 0\r\n    ### log algorithm\r\n     Tenant.notify(message: \"params #{[task.state[\"metadata\"][\"objectNumber\"], task.state[\"metadata\"][\"eventName\"], \"CW::Get Case Documents\", \"OK\", task.state[\"metadata\"][\"event_id\"]]}\")\r\n   create_event_log_alg = Cenit.namespace(\"Cityworks - #{task.state[\"source\"]}\").algorithm(:create_event_log)\r\n\r\n    create_event_log_alg.run([task.state[\"metadata\"][\"objectNumber\"], task.state[\"metadata\"][\"eventName\"], \"CW::Get Case Documents\", \"OK\",task.state[\"metadata\"][\"event_id\"]] )  unless create_event_log_alg.nil?\r\n    \r\n    process_alg = Cenit.namespace(\"Cityworks - #{task.state[\"source\"]}\").algorithm(\"process_case_documents\")\r\n\r\n    if process_alg\r\n      params = {\r\n        'files'=> data[\"files\"],\r\n        'source' => task.state[\"source\"],\r\n        'metadata' => task.state[\"metadata\"],\r\n        'auth_id' => task.state[\"auth_id\"]\r\n        }\r\n\r\n      process_alg.run([params])\r\n    end\r\n\r\n  else\r\n     create_event_log_alg.run([task.state[\"metadata\"][\"objectNumber\"], task.state[\"metadata\"][\"eventName\"], \"CW::Get Case Documents\", \"FAILS\", task.state[\"metadata\"][\"event_id\"]] )  unless create_event_log_alg.nil?\r\n   \r\n    Cenit.fail \"Get Case Documents Parser #{data.to_json}\"\r\n  end\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Set_Task_Status_Template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Set Task Status Exporter parameters #{parameters.to_json}\", type: \"notice\")\r\n\r\ndata = parameters[\"data\"]\r\ndescriptions = JSON.parse(parameters[\"event\"][\"description\"].to_json)\r\n\r\nparameters[\"token\"] = task.state[:token].nil? ? parameters[\"token\"] : task.state[:token]\r\ntask_description = \"#{descriptions[\"#{parameters[\"data\"][\"CaTaskId\"].to_s}\"]}\"\r\ntask.description = task_description\r\nparameters[\"data\"] = data.to_json\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_corrections_by_taskids.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Getting corrections by taskids of #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  \r\n  req = {\r\n    \"CaTaskIds\": data\r\n     }.to_json\r\n  \r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n    response = Cenit.namespace('Cityworks').resource('Get Case Corrections by TaskIds').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    elsif response['Status'] == 0\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      Tenant.notify(message: \"Error response Cityworks Getting corrections by taskids #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting corrections by taskids #{response.to_json}\"}\r\n    end\r\n  end\r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Getting corrections by taskids #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting corrections by taskids #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_users.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Getting Users\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = Cenit.namespace('Cityworks').resource('Get Users').with(authorization['connection']).get(\r\n      template_parameters: { 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    elsif response['Status'] == 0\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      Tenant.notify(message: \"Error response Cityworks Getting Users #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting Users #{response.to_json}\"}\r\n    end\r\n  end\r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Getting Users #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting Users #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_case_task_by_taskids.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Getting task by taskids of #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  \r\n  run_again = true\r\n  \r\n  req = {\r\n    \"CaTaskIds\": data\r\n     }.to_json\r\n\r\n  count = 0\r\n  while run_again and count < 3\r\n    authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n    response = Cenit.namespace('Cityworks').resource('Get CaseTask by TaskId').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n       run_again = true\r\n    elsif response['Status'] == 0\r\n      run_again = false\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      run_again = false\r\n      Tenant.notify(message: \"Retrying Cityworks Getting corrections by taskids #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting corrections by taskids #{response.to_json}\"}\r\n    end\r\n  end\r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Getting corrections by taskids #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting corrections by taskids #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_task_by_case.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Getting task by case of #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    \r\n    authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n    req = {\r\n      \"CaObjectId\": data\r\n     }.to_json\r\n\r\n    \r\n    response = Cenit.namespace('Cityworks').resource('Get Tasks by CaObjectId').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n    Tenant.notify(message: \"Getting case response code: #{response['Status']}\" )\r\n\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    elsif response['Status'] == 0\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      Tenant.notify(message: \"Error response Cityworks Getting task by case #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting task by case #{response.to_json}\"}\r\n    end\r\n  end\r\n    \r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Getting task by case #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Getting task by case #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add_Comment_Parse.rb",
      "type": "ruby",
      "code": "workorder = Cenit.namespace('Cityworks').data_type('WorkOrder').where(WorkOrderId: parameters['activitySid']).first\r\n\r\nparsed_data = JSON.parse(data)\r\n\r\nif parsed_data['Status'].eql?(0)\r\n\r\n  comment = workorder['Comments'].find{|x| x['comment'].eql?(parameters['comment']['comment'])}\r\n\r\n  unless comment.nil?      \r\n    comment['commentId'] = parsed_data['Value']['CommentId']\r\n    comment['activitySid'] = parameters['activitySid']\r\n    workorder.save\r\n\r\n    target_data_type.create_from_json!(comment.to_json)\r\n  end\r\n\r\nelse\r\n  Cenit.fail(data)\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_workorder_after_callback.rb",
      "type": "ruby",
      "code": "if task.state[:source].present? \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  workOrder = task.state[:source]\r\n  \r\n  Tenant.notify(message: \"Processing create WorkOrder request #{workOrder[\"WorkOrderId\"]}\", type: :info)\r\n\r\n  unless workOrder['Comments'].empty?\r\n    add_comments_flow = cw_ns.flow('Add Comment')\r\n\r\n    workOrder['Comments'].each do |c|      \r\n      add_comments_flow.process(\r\n        template_parameters:{\r\n          \"activityType\" => 2,\r\n          \"activitySid\"=> workOrder[\"WorkOrderId\"],\r\n          \"comment\" => c.to_hash\r\n          })\r\n    end\r\n  end\r\n  \r\n  if workOrder['source'] == \"Springbrook\"\r\n    #Add the Entity to created WO\r\n    data = {\r\n      \"EntityType\": \"Well Site\",\r\n      \"EntityUids\": [\"WELL-29\"],\r\n      \"WorkOrderId\": workOrder[\"WorkOrderId\"],\r\n      \"WorkOrderSid\": workOrder[\"WorkOrderSid\"]  \r\n      }\r\n    cw_ns.algorithm(:add_entity_to_work_order).run([workOrder[\"metadata\"][\"cw_auth\"], data])\r\n  end\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_comment_template.rb",
      "type": "ruby",
      "code": "source = options[:template_parameters]['comment']\r\n\r\nTenant.notify(message: \"Adding comment to #{options[:template_parameters]['activitySid']}\", type: :info)\r\n\r\ntask.description = source['metadata']['description']\r\n\r\nauthorization = set_authorization(source['metadata']['cw_auth'])\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\n\r\noptions[:template_parameters]['data'] = {\r\n  \"ActivityType\"=> options[:template_parameters]['activityType'],\r\n  \"ActivitySid\"=> options[:template_parameters]['activitySid'],\r\n  \"Comments\"=> source['comment']\r\n  }.to_json"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_task_by_case(1).rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Create task by case of#{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  req = data.to_json\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n\r\n  \tresponse = Cenit.namespace('Cityworks').resource('Add Task').with(authorization['connection']).post(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    elsif response['Status'] == 0\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      Tenant.notify(message: \"Error response Cityworks Creating task by case #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Creating task by case #{response.to_json}\"}\r\n    end\r\n  end\r\n  \r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Creating task by case #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Creating task by case #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "duplicate_tasks.rb",
      "type": "ruby",
      "code": "begin  \r\n  tasks_details = Cenit.namespace(\"Cityworks\").algorithm(:get_task_by_case).run([auth_id, caseId])\r\n  tasks_details = JSON.parse(tasks_details.to_json)[\"Data\"]\r\n  endTask = tasks_details.detect{|t| t[\"CaTaskId\"].to_s == taskId}\r\n\r\n  #rangos de tareas a buscar\r\n  startStepEndTask = endTask[\"StartPoint\"]\r\n  endPointEndTask = endTask[\"EndPoint\"]\r\n\r\n  rangeStartStep = start_point\r\n\r\n  new_tasks_to_create = []\r\n  tasks_details.each do |t|\r\n      #select task data where the StartStep > 2 and EndStep < 6\r\n    if t[\"StartPoint\"] >= 2 and t[\"EndPoint\"] <= endPointEndTask\r\n      new_task = {\r\n        \"StartPoint\": startStepEndTask,\r\n        \"EndPoint\": endPointEndTask,\r\n        \"CaObjectId\": caseId,\r\n        \"TaskId\": t[\"TaskId\"]\r\n      }\r\n\r\n      tasks_details = Cenit.namespace(\"Cityworks\").algorithm(:create_task_by_case).run([auth_id, new_task])\r\n      tasks_details = JSON.parse(tasks_details.to_json)\r\n      new_tasks_to_create << new_task\r\n    end\r\n\r\n  end\r\n  \r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks duplicate_tasks #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks duplicate_tasks #{ex.message}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "update_task.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Update task by case of#{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  \r\n  \r\n  req = data.to_json\r\n\r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = Cenit.namespace('Cityworks').resource('Update Task').with(authorization['connection']).put(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n    )\r\n    \r\n    response = JSON.parse(response)\r\n\tif response['Status'] == 3\r\n      run_again = true\r\n      count = count + 1\r\n    elsif response['Status'] == 0\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      Tenant.notify(message: \"Error response Cityworks Updating task by case #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Updating task by case #{response.to_json}\"}\r\n    end\r\n  end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Updating task by case #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Updating task by case #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "action_manager_events_controller.rb",
      "type": "ruby",
      "code": "\r\nrequest = controller.try(:controller).request\r\nrequest.body.rewind\r\nreqeustBody = request.body.read\r\nparams = JSON.parse(reqeustBody)\r\n\r\nTenant.notify(message: \"Received new CityWorks Action Manager Event #{params}\", type: :info)\r\n\r\nresponse = {}\r\nif params[\"caseNumber\"].nil?\r\n  response[\"success\"] = false\r\n  response[\"message\"] = \"caseNumber missing from input\"\r\nelsif params[\"eventName\"].nil?\r\n  response[\"success\"] = false\r\n  response[\"message\"] = \"eventName missing from input\"\r\nelsif params[\"eventData\"].nil?\r\n  response[\"success\"] = false\r\n  response[\"message\"] = \"eventData missing from input\"\r\nelse\r\n  \r\n  auth_id = Cenit.namespace(\"Cityworks\").authorization(\"Cityworks\").id\r\n  params[\"eventData\"][\"auth_id\"] = auth_id.to_s\r\n\r\n  Cenit.namespace(\"Cityworks\").data_type(\"Action Manager Events\").create_from_json!(params)\r\n  response[\"success\"] = true\r\n  response[\"message\"] = \"Action manager event created\"\r\nend\r\ncontroller.render json: response, status: (response[\"success\"] == true ? 200 : 400)"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_entity_to_work_order.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Add entity to work order #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  #example\r\n  req = {\r\n      \"EntityType\": data[:EntityType],\r\n      \"EntityUids\": data[:EntityUids] ,\r\n      \"WorkOrderId\": data[:WorkOrderId],\r\n      \"WorkOrderSid\":  data[:WorkOrderSid]    \r\n    }.to_json\r\n\r\n  response = Cenit.namespace('Cityworks').resource('WorkOrder AddEntity').with(authorization['connection']).post(\r\n    template_parameters: { 'data' => req, 'token' => authorization['authorization']['token'] }\r\n  )\r\n\r\n  response = JSON.parse(response)\r\n\r\n  if response['Status'] == 0\r\n    return { \r\n      \"StatusCode\": 200,\r\n      \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n      }\r\n  else\r\n    Tenant.notify(message: \"Error response Cityworks Add entity to work order #{response.to_json}\", type: \"error\")\r\n    return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Add entity to work order  #{response.to_json}\"}\r\n  end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Add entity to work order #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Add entity to work order #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_entity.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Get Entity #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  \r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  #example\r\n  req = {\r\n      \"EntityType\": data[:EntityType]\r\n    }.to_json\r\n  \r\n  run_again = true\r\n  count = 0\r\n  while run_again and count < 3\r\n    response = Cenit.namespace('Cityworks').resource('Search Entity').with(authorization['connection']).get(\r\n      template_parameters: { 'data' => req, 'token' => authorization['authorization']['token']  }\r\n    )\r\n\r\n    response = JSON.parse(response)\r\n\r\n    if response['Status'] == 3\r\n      count = count + 1\r\n      run_again = true\r\n    elsif response['Status'] == 0\r\n      run_again = false\r\n      return { \r\n        \"StatusCode\": 200,\r\n        \"Data\": JSON.parse(response[\"Value\"].to_json)\r\n        }\r\n    else\r\n      run_again = false\r\n      Tenant.notify(message: \"Error response Cityworks Get Entity #{response.to_json}\", type: \"error\")\r\n      return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Get Entity  #{response.to_json}\"}\r\n      \r\n    end\r\n  end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error response Cityworks Get Entity #{ex.message}\", type: \"error\")\r\n  return { \"StatusCode\": 500, \"StatusDescription\": \"Error response Cityworks Get Entity #{response.to_json}\"}\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Update_Document_Template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"CW Update Document Templat #{parameters.to_json}\", type: \"notice\")\r\n\r\ncw_ns = Cenit.namespace(\"Cityworks\")\r\n\r\ndata = parameters[\"data\"]\r\ndoc = cw_ns.data_type(\"Document\").where(docId: data['docId']).first\r\ntask.description = doc[\"metadata\"][\"description\"]#\"Case: #{source['metadata']['caseNumber']} - Task: #{source['metadata']['CaTaskId']}\"\r\ntask.state[:doc_id] = doc.id\r\ntask.state[:retry_count] = 0\r\nparameters[\"token\"] = cw_ns.algorithm(:set_authorization).run(doc.metadata[\"auth_id\"])[\"authorization\"][\"token\"] #parameters[\"token\"]\r\nif doc.source == \"Bluebeam Studio\"\r\n  parameters[\"data\"] = {\r\n    \"CaObjectId\": doc.metadata[\"objectId\"],\r\n    \"CaRelDocId\": doc.docId,\r\n    \"DocName\": doc.name,\r\n    \"LabelText\": doc.labelText\r\n    }.to_json\r\nelse\r\n  parameters[\"data\"] = data.to_json\r\nend\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "enable_next_task_available.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"enable_next_task_available caseId #{caseId}\")\r\nTenant.notify(message: \"enable_next_task_available taskId #{taskId}\")\r\nTenant.notify(message: \"enable_next_task_available event #{event}\")\r\n\r\ncw_ns = Cenit.namespace(\"Cityworks\")\r\nauth_id = cw_ns.authorization(\"Cityworks\").id\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\ntasks_details = cw_ns.algorithm(:get_task_by_case).run([auth_id, caseId])\r\n\r\ntasks_details = JSON.parse(tasks_details.to_json)[\"Data\"]\r\ncurrent_task_obj = tasks_details.detect{|t| t[\"CaTaskId\"].to_s == taskId.to_s}\r\nnext_task_obj = tasks_details.detect{|t| current_task_obj[\"EndPoint\"].to_s == t[\"StartPoint\"].to_s }\r\n\r\n#t = Time.now.getlocal('-8:00')\r\n#Tenant.notify(message: \"3 #{t}\")\r\navailable_date = DateTime.parse(current_task_obj['DateCreated']) - 1\r\ndata = {\r\n    'CaTaskId': next_task_obj['CaTaskId'], \r\n    #'TaskCompleteDate': Time.now + 1.days,\r\n    'TaskAvailableFlag': \"Y\",\r\n  'TaskCompleteDate': current_task_obj['DateModified'], #changed 22/3\r\n  #   'TargetStartDate': current_task_obj['DateCreated'], changed 22/03\r\n    #'TaskAvailableDate': Time.now - 2.days,#available_date, #current_task_obj['DateCreated'],\r\n    'token': authorization['authorization']['token']  \r\n }\r\n\r\n#Cenit.namespace(\"Cityworks\").algorithm(:update_task).run([auth_id, data])  \r\n  Cenit.namespace(\"Cityworks\").flow(\"Update Task\").process(\r\n    object_id: next_task_obj['CaTaskId'],\r\n    template_parameters: {data: data, event: event.eventName, source: \"Bluebeam Studio\", next_task: \"done\", current_event: JSON.parse(event.to_json), current_event_id: event.id.to_s},\r\n    connection: authorization[\"connection\"],\r\n   )  "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Test",
      "name": "test_app.rb",
      "type": "ruby",
      "code": "Cenit.namespace(\"Accela\").flow(\"Get Record\").run(object_id: 1);"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Updae_task_template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Update task parameters #{parameters.to_json}\", type: \"notice\")\r\n\r\ncw_ns = Cenit.namespace('Cityworks')\r\nTenant.notify(message: \"Token #{parameters[\"data\"][\"token\"]}\", type: \"notice\")\r\n\r\nparameters[\"token\"] = task.state[:token].nil? ? parameters[\"data\"][\"token\"] : task.state[:token]\r\ndata = parameters[\"data\"]\r\n\r\nget_description_algorithm = Cenit.namespace(\"Cityworks - #{parameters[\"source\"]}\").algorithm(:get_flow_description)\r\n\r\nif get_description_algorithm.nil?\r\n  #get descirption general from metadata\r\n  descriptions = JSON.parse(parameters[\"metadata\"][\"description\"].to_json)\r\n  task.description = descriptions\r\nelse\r\n  Tenant.notify(message: \"looking description #{parameters[\"current_event_id\"].to_s} - #{data[\"CaTaskId\"]} \")\r\n  task.description = get_description_algorithm.run([parameters[\"current_event_id\"].to_s, data[\"CaTaskId\"].to_s ])\r\nend\r\ntask[:state][\"task_data\"] = data\r\ntask[:state][\"next_task\"] = parameters[\"next_task\"]\r\ntask[:state][\"source\"] = parameters[\"source\"]\r\ntask[:state][\"event\"] = parameters[\"event\"] unless parameters[\"event\"].nil?\r\ntask[:state][\"current_event\"] = parameters[\"current_event\"] unless parameters[\"current_event\"].nil?\r\ntask[:state][\"current_event_id\"] = parameters[\"current_event_id\"] unless parameters[\"current_event_id\"].nil?\r\ntask.state[:count_retry] = 0\r\n\r\n#data[\"LoginId\"] = \"plladmin\"\r\n#data[\"TargetStartDate\"] = data[\"TargetStartDate\"]\r\n#parameters[\"data\"][\"TaskCompleteDate\"]= point_task[\"DateCreated\"],\r\n#parameters[\"data\"][\"TargetEndDate\"]: point_task[\"DateCreated\"],\r\n#data[\"TaskCompletedBy\"] = 1\r\n#data[\"TaskCompletedByLoginID\"] = \"plladmin\"\r\n#data[\"TaskCompleteDate\"] = Time.now + 1.days\r\nTenant.notify(message: \"data to update #{data}\")\r\n#Tenant.notify(message: \"TaskCompleteDate #{data[\"TaskCompleteDate\"]}\")\r\nparameters[\"data\"] = data.to_json"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "after_process_update_task.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"After process callback update task #{task.to_json}\")\r\n\r\nif task.state[:status] == 3 and task.state[:count_retry] <= 3\r\n  Tenant.notify(message: \"Flow retrying Set Task Status #{task.state.to_json}\")\r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  auth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  task.state[:token] = authorization[\"authorization\"][\"token\"]\r\n  task.state[:count_retry] += 1\r\n  task.run_again\r\n  \r\nelse\r\n  if !task[:state]['event'].nil? \r\n    if task[:state]['event'] == \"REVISIONS REQUIRED\" and task[:state]['next_task'] == \"partitions_tasks\"\r\n      \r\n      current_event = task[:state]['current_event']\r\n      current_event_id = task[:state]['current_event_id']\r\n      \r\n      create_event_log_alg = Velosimo.namespace(\"Cityworks - #{task[:state][\"source\"]}\").algorithm(:create_event_log)\r\n\t  create_event_log_alg.run([current_event[\"objectNumber\"], current_event[\"eventName\"], \"CW::Update Task\", \"OK\", current_event_id]) unless create_event_log_alg.nil?\r\n      \r\n      partition_algorithm = Velosimo.namespace(\"Cityworks - #{task[:state][\"source\"]}\").algorithm(:process_partitions_tasks)\r\n      partition_algorithm.run_asynchronous([current_event, current_event_id]) unless partition_algorithm.nil?\r\n      \r\n    elsif task[:state]['event'] == \"REVISIONS REQUIRED\" and task[:state]['next_task'] == \"done\"\r\n      \r\n      Tenant.notify(message: \"DONE\")\r\n      \r\n      event_log = Velosimo.namespace(\"Cityworks - Bluebeam Studio\").data_type(\"Event Log\")\r\n      if event_log        \r\n          event_log_obj = event_log.where(case: current_event[\"objectNumber\"], event_name: current_event[\"eventName\"], event_id: current_event_id).first\r\n        if event_log_obj\r\n          event_log_obj.completed_flows = true\r\n          event_log_obj.metadata = task[:state]\r\n          event_log_obj.save\r\n        end\r\n      end\r\n    end\r\n  end\r\n  \r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "parsing_data.rb",
      "type": "ruby",
      "code": " begin\r\n  unless !!data == data  \r\n    #Getting the variables from the string\r\n    fields = data.scan(/\\{{(.*?)\\}}/)\r\n    unless fields.empty?\r\n\r\n      fields.each do |f|\r\n        f = f[0]\r\n\r\n        value = nil\r\n\r\n        path = f.scan(/^(.*)\\[(.*)='(.*)'\\]\\.(.*)/)\r\n\r\n        if path.empty? # For mappings with simple format {{recordId}} or {{recordType['module']}}\r\n          path = f.scan(/^(.*)\\['(.*)'\\]/)\r\n\r\n          if path.empty? #{{recordId}} case\r\n            value = record[f] \r\n\r\n            if value.is_a?(Hash) #{{status}} case, when status is a hash \r\n              value = value['value']            \r\n            end\r\n          else #{{recordType['module']}} case\r\n\r\n            path = path[0]\r\n\r\n            if record[path[0]].present?\r\n              value = record[path[0]][path[1]]               \r\n            end            \r\n          end\r\n        else # for mappings more complicated like {{contacts[type=Applicant].x}}\r\n\r\n          path = path[0]          \r\n\r\n          if record[path[0]].present?  \r\n\r\n            if path[2].eql?('ALL') #mappings like {{relatedRecords[type='ALL'].x}}             \r\n              value = record[path[0]].map{|x| x[path[3]]}\r\n              value = value.join(',')\r\n              \r\n            else\r\n              object = nil\r\n              i = 0 \r\n\r\n              while i < record[path[0]].count && object.nil?\r\n                aux = record[path[0]][i]\r\n\r\n                if path[1].include?('.')\r\n                  splitted_path = path[1].split('.')                \r\n\r\n                  if aux[splitted_path.first].is_a?(Array)\r\n                    j = 0\r\n                    aux_object = nil\r\n\r\n                    while j < aux[splitted_path.first].count && aux_object.nil?\r\n                      aux2 =  aux[splitted_path.first][j]\r\n\r\n                      if aux2[splitted_path.last].is_a?(Hash)\r\n\r\n                        if aux2[splitted_path.last]['value'].eql?(path[2])\r\n                          aux_object = aux2            \r\n                        end\r\n                      else\r\n                        if \"#{aux2}\".eql?(path[2].to_s)\r\n                          aux_object = aux\r\n                        end\r\n                      end\r\n                      j += 1\r\n                    end\r\n                  else\r\n                    Tenant.notify(message: \"is not array\")\r\n                  end\r\n\r\n                  unless aux_object.nil?                   \r\n                    value = aux_object[path.last]\r\n                  end \r\n                else\r\n                  if aux[path[1]].is_a?(Hash)                  \r\n                    if aux[path[1]]['value'].downcase.eql?(path[2].downcase)\r\n                      object = aux            \r\n                    end\r\n                  else                  \r\n                    if \"#{aux[path[1]]}\".eql?(path[2].to_s)\r\n                      object = aux\r\n                    end\r\n                  end\r\n                end\r\n\r\n                i+= 1\r\n              end\r\n\r\n              unless object.nil?\r\n                value = object[path.last]\r\n              end \r\n            end\r\n          end\r\n        end \r\n\r\n        if value.nil?   \r\n          data.gsub!(\"{{#{f}}}\", \"\")\r\n        else   \r\n          data.gsub!(\"{{#{f}}}\", \"#{value}\")\r\n        end\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\ndata = data.empty? ? nil : data          \r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "calculate_mappings.rb",
      "type": "ruby",
      "code": " data = {}\r\n\r\nparams['mappings'].each do |key, value|\r\n  parsed_value = parsing_data(value, params['record'])\r\n\r\n  unless parsed_value.nil?\r\n    data[key] = parsed_value\r\n  end\r\nend \r\n\r\n{'data'=> data}\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_Document_by_Id_Parse.rb",
      "type": "ruby",
      "code": "cityworks_np = Cenit.namespace('Cityworks')\r\n\r\nparsed_data = JSON.parse(data)\r\n\r\nif parsed_data[\"Status\"].present? && parsed_data[\"Status\"].eql?(3)\r\n  Cenit.fail(parsed_data) \r\nelse\r\n\r\n  #document_content = cityworks_np.algorithm('get_document').run([parameters['auth_id'],parameters['CaRelDocId']])\r\n\r\n  #attachment = cityworks_np.data_type('Attachment').create_from!(document_content, filename: f['name'])\r\n  #f['attachment'] = { \"_reference\": true, \"id\": \"#{attachment.id}\" }\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_document_by_id_template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Requesting Cityworks #{options[:template_parameters]['CaRelDocId']} Document\", type: :info)\r\n\r\nauthorization = set_authorization(options[:template_parameters]['auth_id'])\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\n\r\noptions[:template_parameters]['data'] = {\r\n  \"CaRelDocId\": options[:template_parameters]['CaRelDocId'],\r\n  \"DocName\": nil,\r\n  \"LocationType\": nil,\r\n  \"Location\": nil,\r\n  \"CommentText\": nil\r\n  }.to_json\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Check_respnse_parser.rb",
      "type": "ruby",
      "code": "data = JSON.parse(data)\r\nTenant.notify(message: \"status #{data[\"Status\"] }\")\r\ntask.state[:status] = data[\"Status\"] \r\nTenant.notify(message: \"error #{data[\"ErrorMessages\"]}\")\r\ntask.state[:ErrorMessages] = data[\"ErrorMessages\"] unless data[\"Status\"] != 0\r\n\r\nif data[\"Status\"] == 1\r\n  point_greater_error = data[\"ErrorMessages\"].detect{|e| e[\"Name\"] == \"StartPointGreaterThanMaxEndPoint\"}\r\n  if point_greater_error\r\n    task_data =  task[:state][\"task_data\"]\r\n    handle_error_alg = Velosimo.namespace(\"Cityworks - #{task[:state][\"source\"]}\").algorithm(:handle_error)\r\n    Tenant.notify(message: \"Before algorithm handle error #{task_data}\")\r\n\r\n    handle_error_alg.run([task_data, task[:state]['current_event']['objectId'], task[:state][\"current_event\"], task[:state][\"current_event_id\"]])\r\n\r\n  end\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "approved_deliverable_enable_next_task.rb",
      "type": "ruby",
      "code": "cw_ns = Cenit.namespace(\"Cityworks\")\r\n\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\ncase_tasks = cw_ns.algorithm(:get_task_by_case).run([auth_id, case_id])\r\ncase_tasks = case_tasks[:Data]\r\ncase_tasks = case_tasks.sort_by { |item| item[\"StartPoint\"] }\r\npoint_task = case_tasks.detect{|t| t[\"CaTaskId\"].to_s == taskId.to_s}\r\n\r\npartition_case_tasks = case_tasks.split {|v| v[\"TaskDesc\"] == point_task[\"TaskDesc\"] }\r\nnext_task_to_update = partition_case_tasks[partition_case_tasks.count - 1][0]\r\n\r\n#t = Time.now.getlocal('-8:00')\r\n#Tenant.notify(message: \"next_task_to_update #{next_task_to_update}\")\r\navailable_date = DateTime.parse(next_task_to_update['DateCreated']) - 1\r\ndata = {\r\n    'CaTaskId': next_task_to_update['CaTaskId'], \r\n    #'TaskCompleteDate': Time.now + 1.days,\r\n    'TaskAvailableFlag': \"Y\",\r\n    'TargetStartDate': next_task_to_update['DateCreated'],\r\n    'TaskAvailableDate': available_date,#next_task_to_update['DateCreated'],\r\n    'token': authorization['authorization']['token']  \r\n   }\r\n#Tenant.notify(message: \"data #{data}\")\r\n\r\n  Cenit.namespace(\"Cityworks\").flow(\"Update Task\").process(\r\n    object_id: next_task_to_update['CaTaskId'],\r\n    template_parameters: {data: data, event: \"APPROVED DELIVERABLE\", source: \"Bluebeam Studio\", next_task: \"done\", current_event: JSON.parse(event.to_json), current_event_id: event.id},\r\n    connection: authorization[\"connection\"],\r\n   )  "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "check_flow_response.rb",
      "type": "ruby",
      "code": "if task.state[:status] == 3\r\n  \r\n  Tenant.notify(message: \"Flow retrying Set Task Status #{task.state.to_json}\")\r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  auth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  task.state[:token] = authorization[\"authorization\"][\"token\"]\r\n  task.run_again\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Create_Task_Template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Create task Exporter parameters #{parameters.to_json}\", type: \"notice\")\r\n\r\n#parameters[\"token\"] = parameters[\"token\"]\r\ndata = parameters[\"data\"]\r\n#descriptions = JSON.parse(parameters[\"event\"][\"description\"].to_json)\r\ntask.state[:event] = parameters[\"event\"]\r\ntask.state[:event_id] = parameters[\"event_id\"]\r\ntask.state[:first_task] = parameters[\"first_task\"]\r\ntask.state[:task_to_create] = data[\"TaskDesc\"]\r\ntask.state[:source] = parameters[\"source\"]\r\ntask.state[:last_task_flag] = parameters[\"last_task_flag\"]\r\ntask.state[:second_block] = parameters[\"second_block\"]\r\n\r\n\r\n\r\nparameters[\"token\"] = task.state[:token].nil? ? parameters[\"token\"] : task.state[:token]\r\ntask.state[:token] = parameters[\"token\"]\r\ntask_description = \"#{parameters[\"event\"][\"objectNumber\"]} - Create Task: #{data[\"TaskDesc\"]}\"\r\ntask.description = task_description\r\nparameters[\"data\"] = data.to_json\r\n            \r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Create_Task_Check_response_parser.rb",
      "type": "ruby",
      "code": "data = JSON.parse(data)\r\ntask.state[:status] = data[\"Status\"] \r\n\r\nif task.state[:status] != 3\r\n  if task.state[:first_task]\r\n    task.state[:first_task_json] = data[\"Value\"]\r\n      Tenant.notify(message: \"first task to open #{task.state[:first_task_json]}\")\r\n\r\n  end\r\n\r\n  #last task secuence\r\n  task.state[:last_secuence] = data[\"Value\"][\"TaskSequence\"]\r\n  task.state[:last_new_task] = data[\"Value\"]\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_task_check_flow_response(2).rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"create_task_check_flow_response : #{task.state.to_json}\")\r\ncw_ns = Cenit.namespace('Cityworks')\r\nauth_id = cw_ns.authorization(\"Cityworks\").id\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n\r\nif task.state[:status] == 3\r\n  Tenant.notify(message: \"Flow retrying Set Task Status #{task.state.to_json}\")\r\n  \r\n  task.state[:token] = authorization[\"authorization\"][\"token\"]\r\n  task.run_again\r\nelse\r\n  event = JSON.parse(task.state[:event].to_json)\r\n  current_event_id = task.state[:event_id]\r\n  create_event_log_alg = Velosimo.namespace(\"Cityworks - #{task.state[:source]}\").algorithm(:create_event_log)\r\n  create_event_log_alg.run([event[\"objectNumber\"], event[\"eventName\"], \"CW::Create task #{task.state[:task_to_create]}\", \"OK\", task.state[:event_id]]) unless create_event_log_alg.nil?\r\n  \r\n  if task.state[:last_task_flag] == true\r\n    last_new_task = task.state[:last_new_task]\r\n    update_task = {\r\n        \"CaTaskId\": last_new_task[\"CaTaskId\"],\r\n        \"TaskDesc\": last_new_task[\"TaskDesc\"],    \r\n        \"TaskAvailableDate\": last_new_task[\"DateCreated\"]   \r\n        }    \r\n\r\n        Tenant.notify(message: \"JUST ONCE #{last_new_task[\"TaskDesc\"]}: #{update_task}\")\r\n\r\n        execution = Cenit.namespace(\"Cityworks\").flow(\"Update Task\").process({\r\n          object_id: current_event_id,\r\n          template_parameters: {data: update_task, source: \"Bluebeam Studio\", event: \"REVISIONS REQUIRED\", next_task: \"done\", current_event: JSON.parse(event.to_json), current_event_id: current_event_id},\r\n          connection: authorization[\"connection\"]}\r\n         )\r\n\r\n  end\r\n  if task.state[:last_task_flag] == true and !task.state[:second_block].empty?\r\n    second_block = task.state[:second_block]\r\n    task_secuence_order = task.state[:last_secuence]\r\n    last_new_task = task.state[:last_new_task]\r\n    \r\n    update_task = nil\r\n\r\n  \tflow = Cenit.namespace(\"Cityworks\").flow(\"Update Task\")\r\n    join_task = nil\r\n\r\n    second_block.each_with_index do |sb, i|\r\n      task_secuence_order += 1\r\n    \r\n      if update_task.nil?\r\n        start_point = last_new_task[\"EndPoint\"]\r\n        end_point = start_point + 1\r\n      else\r\n        task_current = sb\r\n        task_before = second_block[i-1]\r\n        start_point = update_task[:StartPoint] + ( task_current[\"StartPoint\"] - task_before[\"StartPoint\"])\r\n        end_point = update_task[:EndPoint] + ( task_current[\"EndPoint\"] - task_before[\"EndPoint\"]) \r\n      end\r\n      update_task = {\r\n        \"TaskDesc\": sb[\"TaskDesc\"],    \r\n        \"TaskSequence\": task_secuence_order, \r\n        \"StartPoint\": start_point,\r\n        \"EndPoint\": end_point,\r\n        \"TaskAvailableDate\": last_new_task[\"TaskAvailableDate\"],\r\n        \"CaTaskId\": sb[\"CaTaskId\"],\r\n        'TaskCompletedBy': last_new_task['TaskCompletedBy'],\r\n        'TaskCompletedByLoginID': last_new_task['TaskCompletedByLoginID'],\r\n        'TaskCompletedByFirstName': last_new_task['TaskCompletedByFirstName'],\r\n        'TaskCompletedByLastName': last_new_task['TaskCompletedByLastName'],\r\n        \"TargetStartDate\": last_new_task[\"TargetStartDate\"],\r\n        'LoginId': last_new_task['LoginId'],\r\n        'FirstName': last_new_task['FirstName'],\r\n        'LastName': last_new_task['LastName'],\r\n        'ResponsibleUserId': last_new_task['ResponsibleUserId']       \r\n        }    \r\n      \r\n      execution = flow.join_process({\r\n        object_id: current_event_id,\r\n        template_parameters: {data: update_task, source: \"Bluebeam Studio\", event: \"REVISIONS REQUIRED\", next_task: \"done\", current_event: JSON.parse(event.to_json), current_event_id: current_event_id},\r\n        connection: authorization[\"connection\"]},\r\n        join_task\r\n       )\r\n      join_task = execution.task\r\n    end\r\n  end\r\n  \r\n  if task.state[:first_task] and !task.state[:first_task_json].nil?\r\n    \r\n    cw_ns = Cenit.namespace('Cityworks')\r\n    auth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\n    authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n    #OPEN THE FIRST TASK OF FIRST BLOCK\r\n    available_date = DateTime.parse(task.state[:first_task_json]['DateCreated']) - 1\r\n    task_open = {\r\n      'CaTaskId': task.state[:first_task_json][\"CaTaskId\"].to_s, \r\n      'TaskAvailableFlag': \"Y\",\r\n      \"TaskAvailableDate\": available_date,\r\n      'TargetStartDate': task.state[:first_task_json][\"DateCreated\"],#task.state[:first_task_json]['DateCreated'],\r\n      'token': task.state[:token]\r\n       }\r\n\r\n    Tenant.notify(message: \"OPEN JUST THE FIRST TASK OF FIRTS BLOCK : #{task_open}\")\r\n    \r\n    Cenit.namespace(\"Cityworks\").flow(\"Update Task\").process(\r\n      object_id: task.state[:first_task_json][\"CaTaskId\"].to_s,\r\n      template_parameters: {data: task_open, source: \"Bluebeam Studio\", event: \"REVISIONS REQUIRED\", next_task: \"done\", current_event: event, current_event_id: task.state[:event_id]},\r\n      connection: authorization[\"connection\"]\r\n     )\r\n  end\r\n  \r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_WorkOrder_Documents_Parse.rb",
      "type": "ruby",
      "code": "data = JSON.parse(data)\r\n\r\nif data[\"Status\"].present? and data[\"Status\"].eql?(3)\r\n  Cenit.fail(\"Error requesting WorkOrder Documents for #{parameters['workOrderId']}: #{data.to_json}\")\r\n\r\nelse\r\n  process_alg = Cenit.namespace(\"Cityworks - #{parameters[\"source\"]}\").algorithm(\"process_workorder_documents\")\r\n\r\n  if process_alg\r\n    parameters['files'] = data[\"Value\"]\r\n\r\n    process_alg.run([parameters])\r\n  end\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_workorder_documents_template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Requesting Cityworks Documents for #{options[:template_parameters]['workOrderId']} WorkOrder\", type: :info)\r\n\r\ntask.description = options[:template_parameters]['metadata']['description']\r\n\r\nauthorization = set_authorization(options[:template_parameters]['auth_id'])\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\n\r\noptions[:template_parameters]['data'] = {\r\n    \"WorkOrderIds\": [options[:template_parameters]['workOrderId']],\r\n    \"WorkOrderSids\": [options[:template_parameters]['workOrderId']]\r\n}.to_json            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks - Bluebealm Studio",
      "name": "create_event_log.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Saving logs case_number #{case_number} event #{event_name}\")\r\nif case_number == \"\" || event_name == \"\" || event_id == \"\"\r\n\r\n  Cenit.fail \"ERROR TO CRETAE EVENT LOG, EMPTY DATA\"\r\nend\r\nevent_dt = Cenit.namespace(\"Cityworks - Bluebeam Studio\").data_type(\"Event Log\")\r\nlog = event_dt.where(case: case_number, event_name: event_name, event_id: event_id).first\r\nif log\r\n  log.flows_executed.append(\"Flow: #{flow_executed}, Response: #{response}\")\r\n  log.save\r\nelse\r\n  flows = [\"Flow: #{flow_executed}, Response: #{response}\"]\r\n  log = event_dt.create_from_json({case: case_number, event_name: event_name, event_id: event_id, flows_executed: flows })\r\n\r\nend\r\n  "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Update_Document_Parser.rb",
      "type": "ruby",
      "code": "data = JSON.parse(data)\r\n\r\nif data[\"Status\"] == 3 and task.state[:retry_count] < 3\r\n  task.retry\r\n  task.state[:retry_count] += 1\r\n  \r\nelse\r\n  \r\n  cw_ns = Cenit.namespace(\"Cityworks\")\r\n  doc = cw_ns.data_type(\"Document\").where(id: task.state[:doc_id]).first\r\n  event_log = Cenit.namespace(\"Cityworks - #{doc.source}\").data_type(\"Event Log\")\r\n  if event_log\r\n    event_log_obj = event_log.where(case: doc.objectId, event_name: doc.metadata[\"eventName\"], event_id: doc.metadata[\"event_id\"]).first\r\n    if event_log_obj\r\n      event_log_obj.completed_flows = true\r\n      event_log_obj.metadata = doc.metadata\r\n      event_log_obj.save\r\n    end\r\n  end\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_User_Template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Get User #{parameters.to_json}\", type: \"notice\")\r\n\r\n#send it to another algorithm\r\nif parameters[\"target\"] == \"Bluebeam Studio\"\r\n  cw_ns = Cenit.namespace('Cityworks')\r\n  auth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\n  authorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\n  parameters[\"token\"] = authorization['authorization']['token']\r\n\r\n  \r\n  event = cw_ns.data_type(\"Action Manager Events\").where(id: parameters[\"event_id\"]).first\r\n  if event\r\n    task.description = event.description[event.eventData[\"CaTaskId\"]]\r\n    task[:state][\"departments\"] = event.eventData[\"departments\"]\r\n    task[:state][\"event_id\"] = parameters[\"event_id\"]\r\n    task[:state][\"target\"] = parameters[\"target\"]\r\n    task[:state][\"description\"] = task.description\r\n    task[:state][\"target\"] = parameters[\"target\"]\r\n    task[:state][\"session_id\"] = parameters[\"session_id\"]\r\n  end\r\nend\r\n\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_User_Parser.rb",
      "type": "ruby",
      "code": "data = JSON.parse(data)\r\ncreate_event_log_alg = Cenit.namespace(\"Cityworks - #{task.state[\"target\"]}\").algorithm(:create_event_log)\r\ncw_ns = Cenit.namespace('Cityworks')\r\nif data[\"Status\"] == 3\r\n  task.run_again\r\nelse\r\n  users = data[\"Value\"]\r\n  \r\n  if !task.state[\"event_id\"].nil?\r\n    event = cw_ns.data_type(\"Action Manager Events\").where(id: parameters[\"event_id\"]).first\r\n      metadata = {\r\n        session_id: task.state[\"session_id\"],\r\n        event_id: task.state[\"event_id\"],\r\n        task_description: task.state[\"description\"],\r\n        departments: task.state[\"departments\"]\r\n        }\r\n\r\n\r\n    create_event_log_alg.run([event[\"objectNumber\"], event[\"eventName\"], \"CW::Get user\", \"OK\", task.state[\"event_id\"]] )  unless create_event_log_alg.nil?\r\n    Velosimo.namespace(\"Cityworks - #{task.state[\"target\"]}\").algorithm(:process_users).run([users, metadata])\r\n\r\n  end\r\n\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "User.json",
      "type": "javascript",
      "code": "{\n  \"type\": \"object\",\n  \"title\": \"User\",\n  \"required\": [\n    \"email\"\n  ],\n  \"properties\": {\n    \"email\": {\n      \"type\": \"string\"\n    },\n    \"target\": {\n      \"type\": \"string\"\n    },\n    \"department_code\": {\n      \"type\": \"boolean\"\n    },\n    \"metadata\": {\n      \"type\": \"object\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add_Document_case_translator.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Add Document case translator #{source.to_json}\")\r\n\r\ndocument = source\r\nauth_id = source.metadata[\"auth_id\"]\r\n\r\nmetadata = Velosimo.namespace(\"Cityworks - #{document.source}\").algorithm(:get_metadata_before_add_doc_to_case).run([document])\r\nif !metadata.nil?\r\n  auth_id = metadata[:auth_id]\r\n  task.state[\"session_id\"] = metadata[:session_id]\r\n  task.description = metadata[:description]\r\nend\r\ntask.state[\"doc_id\"] = metadata[:doc_id]\r\nTenant.notify(message: \"metadata #{metadata}\")\r\nTenant.notify(message: \"auth_id #{auth_id}\")\r\nauthorization = Cenit.namespace('Cityworks').algorithm(:set_authorization).run(auth_id)\r\n\r\nparameters[\"token\"] = authorization['authorization']['token']\r\nparameters[\"data\"] = {\"CaObjectId\" => document.objectId}.to_json\r\nparameters[\"body\"] = {'file' => document.attachment}\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add_Document_to_case_parser.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Add Document to case parser\")\r\ndata = JSON.parse(data)\r\nif data[\"Status\"] == 3\r\n    task.run_again\r\nelse\r\n  document = Velosimo.namespace(\"Cityworks\").data_type(\"Document\").where(id: task.state[\"doc_id\"]).first\r\n  Velosimo.namespace(\"Cityworks - #{document.source}\").algorithm(:process_document_after_add_to_case).run([task.state[\"doc_id\"],task.state[\"session_id\"],data])\r\n\r\nend\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks - Bluebeam Studio",
      "name": "create_document_evaluator(1).rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Create document evaluator #{current.to_json}\", type: \"info\")\r\nreturn true if current[\"docId\"] == nil and current[\"objectType\"] == \"Case\" and current[\"source\"] == \"Bluebeam Studio\"\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "get_contractor_types.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Requesting Cityworks contractor types\", type: :info)\r\n\r\nbegin\r\n  response = {}\r\n\r\n  cityworks_np = Velosimo.namespace('Cityworks')\r\n  contractor_type_dt = cityworks_np.data_type(\"Contractor Type\")\r\n  \r\n  authorization = set_authorization(auth_id)\r\n\r\n  cityworks_np.resource('Get Contractor Types').with(authorization['connection']).get(\r\n    template_parameters: {\r\n      'token'=> authorization['authorization']['token'],\r\n      'data' => {}\r\n      }\r\n    )do |result|\r\n      response['StatusCode'] = result.code\r\n\r\n      if result.code.eql?(200)\r\n        parsed_data = JSON.parse(result.body)\r\n        \r\n        if parsed_data['Value'].present?\r\n          parsed_data['Value'].each do |c|\r\n            contractor_type_dt.create_from_json!(c.to_json, primary_fields:['ContractorTypeId'])\r\n          end\r\n        end\r\n        \r\n        response['StatusDescription'] = 'Success'\r\n        \r\n      else        \r\n        response['StatusDescription'] = \"ERROR requesting contrator types\"        \r\n      end\r\n    end\r\n\r\nrescue StandardError => ex\r\n  Tenant.notify(message: \"Error requesting Cityworks contractor types: #{ex.message}\")\r\n\r\n  response['StatusCode'] = 500\r\n  response['StatusDescription'] = \"Error requesting Cityworks contractor types: #{ex.message}\"\r\nend\r\n\r\nresponse\r\n\r\n\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Contractor_Type.json",
      "type": "javascript",
      "code": "{\n  \"title\": \"Contractor Type\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"ContractorTypeId\": {\n      \"type\": \"string\"\n    },\n    \"ContractorType\": {\n      \"type\": \"string\"\n    },\n    \"ContractorDesc\": {\n      \"type\": \"string\"\n    },\n    \"ExpiredFlag\": {\n      \"type\": \"string\"\n    },\n    \"OrgId\": {\n      \"type\": \"string\"\n    }\n  }\n}"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Search_Case_Contractor_Parse.rb",
      "type": "ruby",
      "code": "if response_code.eql?(200)\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "search_case_contractor_template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Searching Cityworks Case Contractor\")\r\n\r\ntask.description = options[:template_parameters]['description']\r\n\r\nauthorization = set_authorization(options[:template_parameters]['auth_id'])\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\n\r\noptions[:template_parameters]['data'] = {\r\n  \"BusinessName\": options[:template_parameters]['BusinessName'],\r\n  \"CaContractorId\": options[:template_parameters]['CaContractorId'],\r\n  \"CaObjectId\": options[:template_parameters]['CaObjectId'],\r\n  \"CityName\": options[:template_parameters]['CityName'],\r\n  \"ContractorCompanyId\": options[:template_parameters]['ContractorCompanyId'],\r\n  \"ContractorDesc\": options[:template_parameters]['ContractorDesc'],\r\n  \"ContractorType\": options[:template_parameters]['ContractorType'],\r\n  \"ContractorTypeId\": options[:template_parameters]['ContractorTypeId'],\r\n  \"FirstName\": options[:template_parameters]['FirstName'],\r\n  \"LastName\": options[:template_parameters]['LastName'],\r\n  \"LicenseId\": options[:template_parameters]['LicenseId'],\r\n  \"LicenseNum\": options[:template_parameters]['LicenseNum'],\r\n  \"WcLiabilityCompany\": options[:template_parameters]['WcLiabilityCompany']\r\n  }.to_json"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "new_case_document_created_evaluator.rb",
      "type": "ruby",
      "code": "active = false\r\n\r\nif previous.nil?\r\n\r\n  if current['objectType'].eql?('Case') && current['type_of_document'].eql?('New') && \r\n    if current['objectId'].present? && !current['docId'].present?    \r\n\r\n      active = true    \r\n    end\r\n  end\r\nend\r\n\r\nactive"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "new_workorder_document_created_evaluator.rb",
      "type": "ruby",
      "code": "active = false\r\n\r\nif previous.nil?\r\n  if current['objectType'].eql?('WorkOrder') && current['type_of_document'].eql?('New')\r\n    if current['objectId'].present? && !current['docId'].present? \r\n      active = true  \r\n\r\n    end\r\n  end\r\nend\r\n\r\nactive"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add_Document_to_WorkOrder_Parse.rb",
      "type": "ruby",
      "code": "record = target_data_type.where(id: parameters['id']).first\r\n\r\nparsed_data = JSON.parse(data)\r\n\r\nif parsed_data['Status'].eql?(0)\r\n  record['docId'] = parsed_data['Value']['Id']\r\n  \r\n  record.save\r\n  \r\nelse\r\n  Velosimo.fail(parsed_data['Message'])\r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_document_to_workorder_template.rb",
      "type": "ruby",
      "code": " record = task.to_hash['message']['source_id'].present? ? task.to_hash['message']['source_id'] : task.to_hash['message']['object_ids'][0]\r\nsource = Cenit.namespace('Cityworks').data_type('Document').where(id: record).first\r\n\r\nTenant.notify(message: \"Uploading Cityworks Documents to #{source['objectId']} WorkOrder\", type: :info)\r\n\r\ntask.description = source['metadata']['description']\r\n\r\nauthorization = set_authorization(source['auth_id'])\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\noptions[:template_parameters]['id'] = source.id\r\n\r\noptions[:template_parameters]['data'] = {\r\n  \"Comments\": nil,\r\n  \"Filename\": source['name'],\r\n  \"TaskId\": nil,\r\n  \"WorkOrderId\": source['objectId'],\r\n  \"WorkOrderSid\": source['objectId'],\r\n  \"AttachmentType\": 0\r\n  }.to_json \r\n\r\noptions[:body] = {'file' => source['attachment']}\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Delete_Task_Template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Delete task template\")\r\n\r\n cw_ns = Cenit.namespace('Cityworks')\r\nauth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id)\r\nparameters[\"token\"] = authorization[\"authorization\"][\"token\"]\r\n\r\ndata={\r\n  \"CaTaskId\": parameters[\"TaskId\"]\r\n}\r\nparameters[\"data\"] = data.to_json\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add_AttachmentLink_Template.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Add AttachmentLink #{source.to_json} parameters #{parameters.to_json}\")\r\n\r\ntask.description = \"Adding AttachmentLink to WO: #{source.WorkOrderSid}\"\r\n\r\nauth_id = Cenit.namespace('Cityworks').authorization(\"Cityworks\").id.to_s\r\nauthorization = Cenit.namespace('Cityworks').algorithm(:set_authorization).run(auth_id)\r\nparameters[\"token\"] = authorization['authorization']['token']\r\n\r\n#ActivityType is 3 when is WorkOrder\r\n#Attachment 2 when it is an url\r\nbody = {\r\n  \"Comments\": \"#{parameters[\"path_comment\"]}\",\r\n  \"Title\": \"#{parameters[\"path_comment\"]}\",\r\n  \"Description\": \"#{parameters[\"path_comment\"]}\",\r\n  \"Path\": \"#{parameters[\"path\"]}\",\r\n  \"ActivitySid\": \"#{source.WorkOrderSid}\",\r\n  \"ActivityType\": 3,\r\n  \"AttachmentType\": 2\r\n}\r\nparameters[\"data\"] = body.to_json\r\n            "
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Add_AttachmentLink_Parser.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Add AttachmentLink Parser data #{data}\")\r\ndata = JSON.parse(data)\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Get_WO_Entity_Identifier_Parser.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Get WO Entity Identifier Parser #{data.to_json}\")\r\n\r\ndata = JSON.parse(data)\r\n\r\nif data[\"Status\"] == 3 and task.state[:retry_count] < 3\r\n  task.retry\r\n  task.state[:retry_count] += 1\r\nelse\r\n  task.state[:entities_data] = data[\"Value\"]\r\n\r\nend\r\n\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "before_submit_get_wo_entity_identifier.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"task #{task.to_json}\")\r\nrecord = task.to_hash['message']['source_id'].nil? ? task.to_hash['message']['source_id'] : task.to_hash['message']['object_id']\r\nTenant.notify(message: \"record id #{task.to_hash['message']['object_id']}\")\r\n\r\nsource = Velosimo.namespace('Cityworks').data_type('WorkOrder').where(id: task.to_hash['message']['object_id']).first\r\nTenant.notify(message: \"source #{source.to_json}\")\r\ncw_ns = Cenit.namespace('Cityworks')\r\nauth_id = cw_ns.authorization(\"Cityworks\").id\r\n\r\nauthorization = cw_ns.algorithm(:set_authorization).run(auth_id.to_s)\r\n\r\ntask.state[:retry_count] = 0 unless !task.state[:retry_count].nil?\r\ntask.state[:wo_id] = source.id.to_s\r\n\r\noptions[:template_parameters][\"token\"] = authorization['authorization']['token']\r\noptions[:template_parameters]['data'] = {\"WorkOrderIds\": [\"#{source.WorkOrderId}\"]}.to_json\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Citiworks",
      "name": "after_process_get_wo_entity_identifier.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"after_process_get_wo_entity_identifier\")\r\n\r\nwo = Velosimo.namespace(\"Cityworks\").data_type(\"WorkOrder\").where(id: task.state[:wo_id]).first\r\nprocess_result_algorithm = Velosimo.namespace(\"Cityworks - #{wo.source}\").algorithm(:process_work_order_entities).run([wo, task.state[:entities_data]])"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "create_comment_event_evaluator.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"CW::create_comment_event_evaluator\")\r\n\r\nevent = current[\"eventName\"]\r\nTenant.notify(message: \"event #{event}\")\r\n\r\nalgorithm_name = event.downcase\r\nalgorithm_name = algorithm_name.gsub(/\\s/, \"_\")\r\nTenant.notify(message: \"algorithm_name #{algorithm_name}\")\r\n\r\nalg = Velosimo.namespace(\"Cityworks\").algorithm(algorithm_name)\r\nif alg\r\n  alg.run(current)\r\nelse\r\n  Cenit.fail \"Method for event #{current.to_json} is not configured in the tenant\"\r\n  \r\nend\r\n"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "add_comment.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Add comment work order #{data.to_json}\", type: \"notice\")\r\nbegin\r\n\r\n  cityworks_np = Cenit.namespace(\"Cityworks\")\r\n  workorder_dt = cityworks_np.data_type(\"WorkOrder\")\r\n  comment_dt = cityworks_np.data_type(\"Comment\")\r\n  \r\n  if data[\"eventData\"][\"objectType\"] == \"WorkOrder\"\r\n\r\n    work_order = workorder_dt.where(\"WorkOrderId\": data[\"objectId\"]).first\r\n\r\n    unless work_order.nil?\r\n            \r\n      work_order = work_order.to_hash  \r\n\r\n      unless work_order[\"Comments\"].nil?\r\n        exist_comment = work_order[\"Comments\"].find{|x| x[\"commentId\"].eql?(data[\"eventData\"][\"commentId\"])}\r\n\r\n        if exist_comment.nil?      \r\n          exist_comment = work_order['Comments'].find{|x| x['comment'].eql?(data[\"eventData\"][\"comments\"])}\r\n\r\n          if exist_comment.nil?\r\n            exist_comment = work_order['Comments'].find{|x| (x['comment'].split(\"\\n\").join(\"\")).eql?(data[\"eventData\"][\"comments\"].split(\"\\r\\n\").join(\"\"))}\r\n          end\r\n        end\r\n      end\r\n\r\n      if exist_comment.nil?           \r\n\r\n        comment = {}\r\n        comment['activitySid'] = data[\"objectId\"]\r\n        comment['commentId'] = data[\"eventData\"][\"commentId\"]          \r\n        comment['comment'] = data[\"eventData\"][\"comments\"]\r\n        comment['source'] = 'Cityworks' \r\n        comment['state'] = \"To Add\"\r\n        comment['metadata'] = work_order['metadata']         \r\n\r\n        if work_order['Comments'].nil?\r\n          work_order['Comments'] = [comment]\r\n\r\n        else\r\n          work_order['Comments'].push(comment)          \r\n        end\r\n\r\n        \r\n        comment_dt.create_from_json!(comment.to_json, primary_fields: ['activitySid', 'state'])\r\n        wo_obj = workorder_dt.create_from_json!(work_order.to_json, primary_fields: ['WorkOrderId'])\r\n        \r\n      end\r\n    end\r\n  end\r\n\r\nrescue => e\r\n  Tenant.notify(message: \"Error on webhook adding comment to work order #{e.message}\")\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "delete_comment.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Delete comment work order #{data.to_json}\", type: \"notice\")\r\nbegin\r\n  cityworks_np = Cenit.namespace(\"Cityworks\")\r\n  comment_dt = cityworks_np.data_type(\"Comment\")\r\n\r\n  if data[\"eventData\"][\"objectType\"] == \"WorkOrder\"\r\n\r\n    work_order = cityworks_np.data_type(\"WorkOrder\").where(\"WorkOrderId\": data[\"objectId\"]).first\r\n\r\n    unless work_order.nil?\r\n      comment = work_order.Comments.detect{|x| x[\"commentId\"].eql?(data[\"eventData\"][\"commentId\"])}\r\n     \r\n      if comment.nil?\r\n        Cenit.fail \"CommentId #{data[\"eventData\"][\"commentId\"]} doesn't exist in Work Order #{data[\"eventData\"][\"commentId\"]}\"\r\n      \r\n      else\r\n        new_arr = work_order.Comments.select{|x| x[\"commentId\"] != data[\"eventData\"][\"commentId\"]}\r\n        work_order.Comments = new_arr\r\n        work_order.save\r\n\r\n        comment['state'] = \"To Delete\"          \r\n        comment_dt.create_from_json!(comment.to_json)\r\n      end\r\n    end\r\n  end\r\n\r\nrescue => e\r\n  Tenant.notify(message: \"Error on webhook deleting comment to work order #{e.message}\")\r\nend"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "update_comment.rb",
      "type": "ruby",
      "code": "Tenant.notify(message: \"Update comment work order #{data.to_json}\", type: \"notice\")\r\n\r\nbegin\r\n  cityworks_dt = Cenit.namespace(\"Cityworks\")\r\n  comment_dt = cityworks_dt.data_type(\"Comment\")\r\n  \r\n  if data[\"eventData\"][\"objectType\"] == \"WorkOrder\"\r\n    work_order_id = data[\"objectId\"]\r\n\r\n    work_order = cityworks_dt.data_type(\"WorkOrder\").where(\"WorkOrderId\": work_order_id).first\r\n\r\n    unless work_order.nil?\r\n      comment = work_order.Comments.detect{|x| x[\"commentId\"].eql?(data[\"eventData\"][\"commentId\"])}\r\n      \r\n      if comment.nil?\r\n        Cenit.fail \"CommentId #{data[\"eventData\"][\"commentId\"]} doesn't exist in Work Order #{work_order_id}\" \r\n      \r\n      else      \r\n        \r\n        comment[\"comment\"] = data[\"eventData\"][\"comments\"]\r\n        comment['state'] = \"To Update\"\r\n\r\n        comment_dt.create_from_json!(comment.to_json)     \r\n        \r\n         work_order.save\r\n      end\r\n    end\r\n  end\r\n\r\nrescue => e\r\n  Tenant.notify(message: \"Error on webhook updating comment to work order #{e.message}\")\r\nend"
    }
  ],
  "resources": [
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseObject ByIds",
      "path": "/Pll/CaseObject/ByIds",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseObject ByIds"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Authenticate",
      "path": "/General/Authentication/Authenticate",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Authenticate"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseType GetList",
      "path": "/Pll/CaseType/GetList",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseType GetList"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseRelDocs ByCaObjectId",
      "path": "/Pll/CaseRelDocs/ByCaObjectId",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseRelDocs ByCaObjectId"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseRelDocs Download",
      "path": "/PLL/CaseRelDocs/Download",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseRelDocs Download"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseAddress Search",
      "path": "/Pll/CaseAddress/Search",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseAddress Search"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseAddress SearchObject",
      "path": "/Pll/CaseAddress/SearchObject",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseAddress SearchObject"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Case getPeople",
      "path": "/Pll/CasePeople/ByCaObjectId",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Case getPeople"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseObject Search",
      "path": "/Pll/CaseObject/Search",
      "description": "Search for Cases\r\nInclude one or more of the listed search fields. A logical 'and' operation is applied for muliple search fields",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseObject Search"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseRelDocs Add",
      "path": "/Pll/CaseRelDocs/Add",
      "headers": [
        {
          "_primary": [
            "key"
          ],
          "key": "Content-Type",
          "value": "multipart/form-data"
        }
      ],
      "template_parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "data"
        },
        {
          "_primary": [
            "key"
          ],
          "key": "token"
        }
      ],
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseRelDocs Add"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseContractor",
      "path": "/Pll/CaseContractor/SearchObject",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseContractor"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Work order ById",
      "path": "/Ams/WorkOrder/ById",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Work order ById"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Create WorkOrder",
      "path": "/Ams/WorkOrder/Create",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Create WorkOrder"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Comments ByActivityTypes",
      "path": "/Ams/Comment/ByActivityTypes",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Comments ByActivityTypes"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Comment by WorkerOrder",
      "path": "/Ams/WorkOrder/Comments",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Comment by WorkerOrder"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Entity Types",
      "path": "/Ams/Entity/Types",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Entity Types"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Entity Group",
      "path": "/Ams/Entity/Groups",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Entity Group"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get TemplateNames",
      "path": "/Ams/WorkOrderTemplate/TemplateNames",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get TemplateNames"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Comment By Activity",
      "path": "/Ams/Comment/ByActivityIds",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Comment By Activity"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Designer Domains",
      "path": "/Ams/Designer/Domains",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Designer Domains"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get CaseTask by TaskId",
      "path": "/Pll/CaseTask/ByIds",
      "description": "Return Task and Case info by TaskId",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get CaseTask by TaskId"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Set Task Status",
      "path": "/Pll/CaseTask/SetResult",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Set Task Status"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Case Corrections by TaskIds",
      "path": "/Pll/CaseCorrections/ByCaTaskIds",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Case Corrections by TaskIds"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Users",
      "path": "/Pll/User/All",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Users"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Tasks by CaObjectId",
      "path": "/Pll/CaseTask/ByCaObjectId",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Tasks by CaObjectId"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Add Comment",
      "path": "/Ams/Comment/Add",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Add Comment"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Add Task",
      "path": "Pll//CaseTask/Add",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Add Task"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Update Task",
      "path": "/Pll/CaseTask/Update",
      "operations": [
        {
          "_reference": true,
          "method": "put",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Update Task"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "WorkOrder AddEntity",
      "path": "/Ams/WorkOrder/AddEntities",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "WorkOrder AddEntity"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Search Entity",
      "path": "/Ams/Entity/Search",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Search Entity"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseRelDocs Update",
      "path": "/Pll/CaseRelDocs/Update",
      "operations": [
        {
          "_reference": true,
          "method": "put",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseRelDocs Update"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "CaseRelDocs By Id",
      "path": "/Pll/CaseRelDocs/Search",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "CaseRelDocs By Id"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get WorkOrder Documents",
      "path": "/Ams/Attachments/WorkOrderAttachments",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get WorkOrder Documents"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Download WorkOrder Document",
      "path": "/Ams/Attachments/DownloadWorkOrderAttachment",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Download WorkOrder Document"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get Contractor Types",
      "path": "/Pll/ContractorType/All",
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get Contractor Types"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Add Document to WorkOrder",
      "path": "/Ams/Attachments/AddWorkOrderAttachment",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Add Document to WorkOrder"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Delete task",
      "path": "/Pll/CaseTask/Delete",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Delete task"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "AddActivityFileLink",
      "path": "/Ams/Attachments/AddActivityFileLink",
      "operations": [
        {
          "_reference": true,
          "method": "post",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "AddActivityFileLink"
          }
        }
      ]
    },
    {
      "_primary": [
        "name",
        "namespace"
      ],
      "namespace": "Cityworks",
      "name": "Get WorkOrderEntityIdentifier",
      "path": "/Ams/WorkOrderEntity/ByWorkOrderIds",
      "parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "data",
          "value": "{{data}}"
        }
      ],
      "template_parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "data"
        }
      ],
      "operations": [
        {
          "_reference": true,
          "method": "get",
          "resource": {
            "_reference": true,
            "namespace": "Cityworks",
            "name": "Get WorkOrderEntityIdentifier"
          }
        }
      ]
    }
  ],
  "operations": [
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseObject ByIds"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Authenticate"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseType GetList"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseRelDocs ByCaObjectId"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseRelDocs Download"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseAddress Search"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseAddress SearchObject"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case getPeople"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseObject Search"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseRelDocs Add"
      },
      "parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "data",
          "value": "{{data}}"
        },
        {
          "_primary": [
            "key"
          ],
          "key": "token",
          "value": "{{token}}"
        }
      ]
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseContractor"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Work order ById"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Create WorkOrder"
      },
      "parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "token",
          "value": "{{token}}"
        },
        {
          "_primary": [
            "key"
          ],
          "key": "data",
          "value": "{{data}}"
        }
      ]
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Comments ByActivityTypes"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Comment by WorkerOrder"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Entity Types"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Entity Group"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get TemplateNames"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Comment By Activity"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Designer Domains"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get CaseTask by TaskId"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Set Task Status"
      },
      "parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "token",
          "value": "{{token}}"
        },
        {
          "_primary": [
            "key"
          ],
          "key": "data",
          "value": "{{data}}"
        }
      ]
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Case Corrections by TaskIds"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Users"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Tasks by CaObjectId"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Comment"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Task"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "put",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Update Task"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder AddEntity"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Search Entity"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "put",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseRelDocs Update"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "CaseRelDocs By Id"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get WorkOrder Documents"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Download WorkOrder Document"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get Contractor Types"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Add Document to WorkOrder"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Delete task"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "post",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "AddActivityFileLink"
      }
    },
    {
      "_primary": [
        "resource",
        "method"
      ],
      "_type": "Setup::Operation",
      "method": "get",
      "resource": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Get WorkOrderEntityIdentifier"
      }
    }
  ],
  "connections": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Cityworks API",
      "authorization_handler": false,
      "url": "https://{{instance}}/services",
      "parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "data",
          "value": "{{data}}"
        }
      ],
      "headers": [
        {
          "_primary": [
            "key"
          ],
          "key": "Authorization",
          "value": "cityworks {{token}}"
        }
      ],
      "template_parameters": [
        {
          "_primary": [
            "key"
          ],
          "key": "instance",
          "value": "partner-app01.cityworks.com/_PARTNER_KSMMS_CURRENT_Velosimo"
        },
        {
          "_primary": [
            "key"
          ],
          "key": "token"
        },
        {
          "_primary": [
            "key"
          ],
          "key": "data"
        }
      ]
    }
  ],
  "data_types": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Action Manager Events",
      "title": "Action Manager Events",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Action_Manager_Events.json"
      },
      "slug": "action_manager_events",
      "navigation_link": true
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::FileDataType",
      "namespace": "Cityworks",
      "name": "Attachment",
      "title": "Attachment",
      "id_type": "default",
      "slug": "attachment"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "WorkOrder",
      "title": "WorkOrder",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "WorkOrder.json"
      },
      "slug": "work_order"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Document",
      "title": "Document",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Document.json"
      },
      "slug": "document"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Comment",
      "title": "Comment",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Comment.json"
      },
      "slug": "comment"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Work Order Type",
      "title": "Work Order Type",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Work_Order_Type.json"
      },
      "slug": "work_order_code"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Module",
      "title": "Module",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Module.json"
      },
      "slug": "module"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Service Request",
      "title": "Service Request",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Service_Request.json"
      },
      "slug": "service_request"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Case",
      "title": "Case",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Case(1).json"
      },
      "slug": "case"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "User",
      "title": "User",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "User.json"
      },
      "slug": "user"
    },
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::JsonDataType",
      "namespace": "Cityworks",
      "name": "Contractor Type",
      "title": "Contractor Type",
      "discard_additional_properties": true,
      "snippet": {
        "_reference": true,
        "namespace": "Cityworks",
        "name": "Contractor_Type.json"
      },
      "slug": "contractor_type"
    }
  ],
  "authorizations": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "namespace": "Cityworks",
      "name": "Cityworks",
      "username": "plladmin",
      "password": "V3losimo!",
      "_type": "Setup::BasicAuthorization"
    }
  ],
  "oauth_providers": [
    {
      "_primary": [
        "namespace",
        "name"
      ],
      "_type": "Setup::Oauth2Provider",
      "namespace": "Cenit",
      "name": "OAuth",
      "authorization_endpoint": "https://connect.velosimo.io/oauth/authorize",
      "response_type": "code",
      "token_endpoint": "https://connect.velosimo.io/oauth/token",
      "token_method": "POST",
      "refresh_token_strategy": "default"
    }
  ]
}